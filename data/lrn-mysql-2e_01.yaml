- en: Chapter 1\. Installing MySQL
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第一章 安装MySQL
- en: Let’s begin our learning path by installing MySQL and accessing it for the first
    time.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过安装MySQL并首次访问它开始我们的学习之旅。
- en: Note that we do not rely on a single version of MySQL for this book. Instead,
    we have drawn on our collective knowledge of MySQL in the real world. The book’s
    core is focused on Linux operating systems (mostly Ubuntu/Debian and CentOS/RHEL
    or its derivatives) and on MySQL 5.7 and MySQL 8.0, because those are what we
    consider the “current” versions capable of production workloads. The MySQL 5.7
    and 8.0 series are still under development, which means that newer versions with
    bug fixes and new features will continue to be released.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们在本书中并不依赖于单一版本的MySQL。相反，我们从我们在现实世界中对MySQL的集体知识中汲取。本书的核心集中在Linux操作系统（主要是Ubuntu/Debian和CentOS/RHEL或其衍生版）和MySQL
    5.7以及MySQL 8.0上，因为我们认为这些是适合生产工作负载的“当前”版本。MySQL 5.7和8.0系列仍在开发中，这意味着将继续发布具有错误修复和新功能的新版本。
- en: 'With MySQL becoming the [most popular](https://oreil.ly/pPG4q) open source
    database (Oracle, which ranks first, is not open source), the demand for having
    a fast installation process has increased. You can think of installing MySQL from
    scratch as similar to baking a cake: the source code is the recipe. But even with
    the source code available, the recipe for building software is not easy to follow.
    It takes time to compile, and usually, it is necessary to install additional development
    libraries that expose production environments to risk. Say you want a chocolate
    cake; even if you have the instructions for how to make it yourself, you may not
    want to mess up your kitchen, or you may not have the time to bake it, so you
    go to a bakery and buy one instead. For MySQL, when you want it ready to use without
    the effort involved in compiling it, you can use the *distribution packages*.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 随着MySQL成为[最受欢迎的](https://oreil.ly/pPG4q)开源数据库（排名第一的Oracle并非开源），对快速安装过程的需求也在增加。您可以把从头安装MySQL想象成烘焙蛋糕：源代码就是配方。但即使有了源代码，构建软件的配方也不容易跟随。编译需要时间，并且通常需要安装额外的开发库，这会使生产环境面临风险。假设你想要一个巧克力蛋糕；即使你有自己制作的说明，你可能不想把厨房弄乱，或者没有时间亲自烘焙，所以你去面包店买了一个。对于MySQL，当您希望它在不需要编译的情况下即可使用时，您可以使用*分发包*。
- en: Distribution packages for MySQL are available for diverse platforms, including
    Linux distributions, Windows, and macOS. These packages provide a flexible and
    fast way to start using MySQL. Returning to the chocolate cake example, suppose
    you want to change something. Maybe you want a white chocolate cake. For MySQL,
    we have what are called forks, which include some different options. We’ll look
    at a few of these in the next section.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL的分发包适用于各种平台，包括Linux发行版、Windows和macOS。这些包提供了一个灵活和快速的开始使用MySQL的方式。回到巧克力蛋糕的例子，假设你想改变一些东西。也许你想要一个白巧克力蛋糕。对于MySQL，我们有所谓的分支，其中包括一些不同的选项。我们将在下一节中看看其中几个。
- en: MySQL Forks
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MySQL分支
- en: In software engineering, a *fork* occurs when someone copies the source code
    and starts their own path of independent development and support. The fork can
    follow a track close to that of the original version, as the Percona distribution
    of MySQL does, or drift away, like MariaDB. Because the MySQL source code is open
    and free, new projects can fork the code without permission from its original
    creator. Let’s take a look at a few of the most notable forks.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在软件工程中，*分支*发生在某人复制源代码并开始独立开发和支持的路径时。分支可以沿着接近原始版本的轨道进行，就像Percona分发的MySQL一样，也可以像MariaDB一样偏离。由于MySQL源代码是开放和免费的，新项目可以在不需要原始创建者许可的情况下分叉代码。让我们来看看一些最显著的分支。
- en: MySQL Community Edition
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MySQL社区版
- en: MySQL Community Edition, also known as the *upstream* or *vanilla* version of
    MySQL, is the open source version distributed by Oracle. This version drives the
    development of the InnoDB engine and new features, and it is the first one to
    receive updates, new features, and bug fixes.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL社区版，也称为MySQL的*上游*或*原版*版本，是由Oracle分发的开源版本。这个版本推动了InnoDB引擎和新功能的开发，并且是第一个接收更新、新功能和错误修复的版本。
- en: Percona Server for MySQL
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Percona MySQL服务器
- en: The Percona distribution of MySQL is a free, open source, drop-in replacement
    for MySQL Community Edition. The development closely follows that version, focusing
    on improving performance and the overall MySQL ecosystem. Percona Server also
    includes additional enhancements like the MyRocks engine, an Audit Log plugin,
    and a PAM Authentication plugin. Percona was cofounded by [Peter Zaitsev](https://oreil.ly/MfiKb)
    and [Vadim Tkachenko](https://oreil.ly/283nR).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Percona的MySQL发行版是MySQL社区版的免费开源替代品。其开发密切跟随该版本，专注于提高性能和整体MySQL生态系统。Percona Server还包括额外的增强功能，如MyRocks引擎、审计日志插件和PAM认证插件。Percona由[Peter
    Zaitsev](https://oreil.ly/MfiKb)和[Vadim Tkachenko](https://oreil.ly/283nR)共同创立。
- en: MariaDB Server
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MariaDB服务器
- en: Created by [Michael “Monty” Widenius](https://oreil.ly/PRoMh) and distributed
    by the MariaDB Foundation, MariaDB Server is by far the fork that has drifted
    the furthest away from vanilla MySQL. In recent years it has developed new features
    and engines such as MariaDB ColumnStore, and it was the first database to integrate
    Galera 4 clustering functionality.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 由[Michael “Monty” Widenius](https://oreil.ly/PRoMh)创建并由MariaDB基金会分发，MariaDB服务器迄今为止是最远离原始MySQL的分支。近年来，它开发了新功能和引擎，如MariaDB
    ColumnStore，并且是第一个集成Galera 4集群功能的数据库。
- en: MySQL Enterprise Edition
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MySQL企业版
- en: MySQL Enterprise Edition is currently the only version with a commercial license
    (which means you need to pay to use it, like a Windows license). Also distributed
    by Oracle, it contains all the functionality of the Community Edition plus exclusive
    features for security, backup, and high availability.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL企业版目前是唯一具有商业许可证的版本（这意味着您需要付费使用，类似于Windows许可证）。由Oracle公司分发，它包含了社区版的所有功能，以及专为安全性、备份和高可用性而设的独家功能。
- en: Installation Choices and Platforms
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装选择和平台
- en: First, you must choose the MySQL version compatible with your operating system
    (OS). You can verify compatibility with the [MySQL website](https://oreil.ly/DTRSR).
    The same support policies are available for [Percona Server](https://oreil.ly/1ahne)
    and [MariaDB](https://oreil.ly/7SYE4).
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您必须选择与您操作系统（OS）兼容的MySQL版本。您可以通过[MySQL网站](https://oreil.ly/DTRSR)验证兼容性。同样的支持政策也适用于[Percona
    Server](https://oreil.ly/1ahne)和[MariaDB](https://oreil.ly/7SYE4)。
- en: 'We often hear the question: is it possible to install MySQL on an OS that is
    not supported? Most of the time, the answer is yes. It is possible to install
    MySQL on Windows 7, for example, but the risks of hitting a bug or facing unpredictable
    behavior (like memory leaks or underperformance) are high. Because of these risks,
    we do not recommend doing this for production environments.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们经常听到这样的问题：能否在不支持的操作系统上安装MySQL？大多数情况下，答案是可以的。例如，可以在Windows 7上安装MySQL，但碰到错误或面临不可预测的行为（如内存泄漏或性能不佳）的风险较高。由于这些风险，我们不建议在生产环境中这样做。
- en: The next step is to decide whether to install a *development* or *General Availability*
    (GA) release. Development releases have the newest features, but we do not recommend
    them for production because they are not stable. GA releases, also called *production*
    or *stable* releases, are meant for production use.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是决定是否安装*开发*版或*稳定可用*（GA）版。开发版拥有最新功能，但我们不建议在生产环境中使用，因为它们不稳定。GA版，也称为*生产*或*稳定*版，适用于生产环境使用。
- en: Tip
  id: totrans-19
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: We highly recommend using the most recent GA release because this will include
    the latest stable bug fixes and performance improvements.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们强烈建议使用最新的GA版，因为它包含了最新的稳定性修复和性能优化。
- en: The last thing to decide is which distribution format to install for the operating
    system. For most use cases, a binary distribution fits. Binary distributions are
    available in native format for many platforms, such as *.rpm* packages for Linux
    or *.dmg* packages for macOS. The distributions are also available in generic
    formats, such as *.zip* archives or compressed *.tar* files (*tarballs*). On Windows,
    you can use the MySQL Installer to install a binary distribution.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 最后要决定的是安装操作系统的分发格式。对于大多数用例，二进制分发是最合适的。二进制分发在许多平台上都有本地格式，例如Linux的*.rpm*包或macOS的*.dmg*包。分发还以通用格式提供，如*.zip*归档或压缩的*.tar*文件（tarballs）。在Windows上，您可以使用MySQL安装程序安装二进制分发。
- en: Warning
  id: totrans-22
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: Watch out for whether the version is 32-bit or 64-bit. The rule of thumb is
    to pick the 64-bit version. Unless you are working with an ancient OS, you should
    *not* select the 32-bit version. This is because 32-bit processors can handle
    only a limited amount of RAM (4 GB or less), whereas 64-bit processors are capable
    of addressing much more memory.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 注意版本是否为32位或64位。一般原则是选择64位版本。除非您使用古老的操作系统，否则不应选择32位版本。这是因为32位处理器只能处理有限量的RAM（4GB或更少），而64位处理器能够处理更多内存。
- en: The installation process consists of four major steps, outlined in the following
    sections. It’s essential to follow these correctly and to set the minimum security
    requirements for the MySQL database.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程包括四个主要步骤，如下部分所述。正确遵循这些步骤并设置MySQL数据库的最低安全要求至关重要。
- en: 1\. Download the Distribution that You Want to Install
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1\. 下载要安装的分发版
- en: Each distribution has its owner and, by consequence, its source. Some Linux
    distributions provide default packages in their repositories. For example, on
    CentOS 8, the MySQL vanilla distribution is available from the default repositories.
    When the OS has default packages available, it is unnecessary to download MySQL
    from a website or configure a repository yourself, which facilitates the installation
    process.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 每个发行版都有其所有者，因此也有其来源。一些Linux发行版在其仓库中提供默认软件包。例如，在CentOS 8上，MySQL原始发行版可从默认仓库获取。当操作系统有默认软件包可用时，无需从网站下载MySQL或自行配置仓库，这简化了安装过程。
- en: 'We will demonstrate how to install the repositories and download the files
    without the need to go to the website during the installation process. However,
    if you do want to download MySQL yourself, you can use the following links:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将展示如何在安装过程中无需访问网站即可安装仓库并下载文件。但是，如果您确实想自行下载MySQL，可以使用以下链接：
- en: '[MySQL Community Server](https://oreil.ly/sBR5i)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[MySQL社区服务器](https://oreil.ly/sBR5i)'
- en: '[Percona Server for MySQL](https://oreil.ly/R9oO4)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Percona MySQL服务器](https://oreil.ly/R9oO4)'
- en: '[MariaDB Server](https://oreil.ly/a78XW)'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[MariaDB服务器](https://oreil.ly/a78XW)'
- en: 2\. Install the Distribution
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2\. 安装分发版
- en: Installing consists of the elementary steps to make MySQL functional and bring
    it online, but not securing MySQL. For example, at this point, the MySQL root
    user can connect without a password, which is quite hazardous since the root user
    has privileges to perform every action, including dropping a database.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 安装包括使MySQL功能正常并将其联机的基本步骤，但不包括安全设置。例如，在此时，MySQL的root用户可以无需密码连接，这非常危险，因为root用户具有执行所有操作的特权，包括删除数据库。
- en: 3\. Perform Any Necessary Post-Installation Setup
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3\. 执行任何必要的安装后设置
- en: This step is about making sure the MySQL server is working correctly. It is
    essential to make sure that your server is secure, and the first step for this
    is executing the *mysql_secure_installation* script. You’ll change the password
    for the root user, disable access for the root user from a remote server, and
    remove the test database.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 此步骤涉及确保MySQL服务器正常工作。确保服务器安全非常重要，首先要执行*mysql_secure_installation*脚本。您将更改root用户的密码，禁用远程服务器对root用户的访问，并删除测试数据库。
- en: 4\. Run Benchmarks
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4\. 运行基准测试
- en: Some DBAs run benchmarks for each deployment to measure whether the performance
    is suitable for the project they are using it for. The most common tool for this
    is [`sysbench`](https://oreil.ly/ioyXF). It’s essential to highlight here that
    `sysbench` performs a *synthetic workload*, whereas when the application is running,
    we call it the *real workload*. Synthetic workloads usually provide reports about
    the maximum server performance, but they can’t reproduce the real-world workload
    (with its inherent locks, different query execution times, stored procedures,
    triggers, and so on).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 一些数据库管理员为每个部署运行基准测试，以测量其性能是否适合他们正在使用的项目。这项工作的最常见工具是[`sysbench`](https://oreil.ly/ioyXF)。这里需要强调的是，`sysbench`执行的是*合成工作负载*，而在应用程序运行时，我们称其为*真实工作负载*。合成工作负载通常提供关于最大服务器性能的报告，但无法复制真实世界的工作负载（其中包括固有的锁定、不同的查询执行时间、存储过程、触发器等）。
- en: In the next section we’ll walk through the details of the installation process
    for a few of the most commonly used platforms.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分中，我们将详细介绍几个常用平台的安装过程细节。
- en: Installing MySQL on Linux
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Linux上安装MySQL
- en: The Linux ecosystem is diverse and has many variants, including Red Hat Enterprise
    Linux (RHEL), CentOS, Ubuntu, Debian, and others. This section focuses on only
    the most popular ones—otherwise, this book would be entirely about the installation
    process!
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: Linux生态系统多样化，有许多变体，包括Red Hat Enterprise Linux（RHEL）、CentOS、Ubuntu、Debian等。本节仅关注最流行的几种——否则，本书将完全围绕安装过程展开！
- en: Installing MySQL on CentOS 7
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在CentOS 7上安装MySQL
- en: '*CentOS*, short for Community Enterprise Linux Operating System, was founded
    in 2004, and Red Hat acquired it in 2014\. CentOS is the community version of
    Red Hat, so they’re pretty much identical, but CentOS is free, and support comes
    from the community instead of Red Hat itself. CentOS 7 was released in 2014, and
    its end-of-life date is in 2024.'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '*CentOS*，即社区企业Linux操作系统，成立于2004年，Red Hat在2014年收购了它。CentOS是Red Hat的社区版本，它们几乎相同，但CentOS是免费的，支持来自社区而不是Red
    Hat本身。CentOS 7于2014年发布，其终止生命周期日期为2024年。'
- en: Installing MySQL 8.0
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装MySQL 8.0
- en: To install MySQL 8.0 on CentOS 7 using the *yum* repository, complete the following
    steps.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用*yum*仓库在CentOS 7上安装MySQL 8.0，请完成以下步骤。
- en: Log in to Linux server
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 登录到Linux服务器
- en: 'Usually, for security reasons, users log into Linux servers as nonprivileged
    users. Here is an example of a user logging into Linux from a macOS terminal using
    a private key:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 出于安全原因，通常用户作为非特权用户登录Linux服务器。以下是一个用户在macOS终端使用私钥登录Linux的示例：
- en: '[PRE0]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'After you’ve successfully connected, you’ll see something like this in the
    terminal:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 成功连接后，您将在终端中看到如下内容：
- en: '[PRE1]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Become root in Linux
  id: totrans-49
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在Linux中成为root用户
- en: 'Once you’re connected to the server, you need to become root:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦连接到服务器，您需要成为root用户：
- en: '[PRE2]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'You will then see a prompt like the following in your terminal:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您将在终端中看到如下提示：
- en: '[PRE3]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Becoming root is important because to install MySQL it is necessary to perform
    tasks such as creating the MySQL user in Linux, configuring directories, and setting
    permissions. It is also possible to use the `sudo` command for all examples we
    will show that should be executed by the root user. However, if you forget to
    prefix a command with `sudo`, the installation process will be incomplete.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 成为root用户非常重要，因为要安装MySQL，必须执行诸如在Linux中创建MySQL用户、配置目录和设置权限等任务。对于我们将展示的所有示例，都应由root用户执行`sudo`命令。然而，如果您忘记使用`sudo`前缀命令，安装过程将无法完成。
- en: Note
  id: totrans-55
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: This chapter will use the Linux root user in the majority of the examples (represented
    by the prompt `#` in the code lines). Another advantage of the `#` representation
    is that this is also the comment character in Linux. If you blindly copy/paste
    lines from the book, you won’t run any real commands in the shell.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将在大多数示例中使用Linux root用户（在代码行中由`#`表示）。`#`的另一个优点是它也是Linux中的注释字符。如果您从本书盲目复制/粘贴行，将无法在shell中运行任何实际命令。
- en: Configure the yum repository
  id: totrans-57
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置yum仓库
- en: 'Execute the following command to configure the MySQL *yum* repository:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下命令配置MySQL *yum*仓库：
- en: '[PRE4]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Install MySQL 8.0 Community Server
  id: totrans-60
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装MySQL 8.0 Community Server
- en: 'Because the MySQL *yum* repository has repositories for multiple MySQL versions
    (5.7 and 8.0 major versions), first we have to disable all repositories:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 因为MySQL *yum*仓库支持多个MySQL版本（主要版本为5.7和8.0），所以首先我们需要禁用所有仓库：
- en: '[PRE5]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Next, we need to enable the MySQL 8.0 repository and execute the following
    command to install MySQL 8.0:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要启用MySQL 8.0仓库并执行以下命令来安装MySQL 8.0：
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Start the MySQL service
  id: totrans-65
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动MySQL服务
- en: 'Now, start the MySQL service with the `systemctl` command:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用`systemctl`命令启动MySQL服务：
- en: '[PRE7]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'It is also possible to start the MySQL process manually, which can be useful
    to troubleshoot initialization problems when MySQL is refusing to start. To start
    manually, indicate the location of the *my.cnf* file and which user can manipulate
    the database files and the process:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当MySQL拒绝启动时，手动启动MySQL进程也是可能的，这对于排除初始化问题非常有用。要手动启动，请指定*my.cnf*文件的位置以及可以操作数据库文件和进程的用户：
- en: '[PRE8]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Discover the default password for the root user
  id: totrans-70
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 查找root用户的默认密码
- en: 'When you install MySQL 8.0, MySQL creates a temporary password for the root
    user account. To identify the password of the root user account, execute the following
    command:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 安装MySQL 8.0时，MySQL会为root用户帐户创建临时密码。要识别root用户帐户的密码，请执行以下命令：
- en: '[PRE9]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The command provides output like the following:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 命令会提供以下输出：
- en: '[PRE10]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Secure the MySQL installation
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安全性MySQL安装
- en: 'MySQL provides a shell script that you can run on Unix systems, *mysql_secure_installation*,
    that enables you to improve the security of your server installation in the following
    ways:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 提供了一个在 Unix 系统上运行的 shell 脚本，*mysql_secure_installation*，可让您通过以下方式改进服务器安装的安全性：
- en: You can set a password for the root account.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以为 root 帐户设置密码。
- en: You can disable root access from outside the localhost.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以禁用来自 localhost 之外的 root 访问。
- en: You can remove anonymous user accounts.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以移除匿名用户账户。
- en: You can remove the test database, which by default can be accessed by anonymous
    users.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认情况下，您可以删除测试数据库，匿名用户可以访问该数据库。
- en: 'Execute the command `mysql_secure_installation` to secure the MySQL server:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 执行命令 `mysql_secure_installation` 以保护 MySQL 服务器：
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'It will prompt you for the current password of the root account:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 系统将提示您输入 root 帐户的当前密码：
- en: '[PRE12]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Enter the temporary password obtained in the previous step and press Enter.
    The following message will appear:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 输入在前一步骤中获得的临时密码，然后按 Enter。将出现以下消息：
- en: '[PRE13]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Note
  id: totrans-87
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: This section will cover only the basics of changing the root password to grant
    access to the MySQL server. We will show more details about granting privileges
    and creating a password policy in [Chapter 8](ch08.xhtml#CH8_USER_MANAGEMENT).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 此部分仅介绍更改 root 密码以授予访问 MySQL 服务器的基础知识。我们将在[第 8 章](ch08.xhtml#CH8_USER_MANAGEMENT)中详细展示授予权限和创建密码策略的更多细节。
- en: 'You will need to enter the new password for the root account twice. More recent
    MySQL versions come with a validation policy, which means that the new password
    needs to respect minimal requirements to be accepted. The default requirements
    are that passwords must be at least eight characters long and include:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要输入 root 帐户的新密码两次。较新的 MySQL 版本带有验证策略，这意味着新密码需要符合最低要求才能接受。默认要求是密码至少为八个字符，并包括：
- en: At least one numeric character
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少包含一个数字字符
- en: At least one lowercase character
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少包含一个小写字母
- en: At least one uppercase character
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少包含一个大写字母
- en: At least one special (nonalphanumeric) character
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少包含一个特殊字符（非字母数字字符）
- en: 'Next, it will prompt you with some yes/no questions about whether you want
    to make some initial setup changes. To ensure maximum protection, we recommend
    removing anonymous users, disabling remote root login, and removing the test database
    (i.e., answering *yes* for all options):'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，系统将提示您是否要对一些初始设置进行更改（是/否）。为了确保最大保护，我们建议删除匿名用户，禁用远程 root 登录，并删除测试数据库（即对所有选项都回答
    *是*）：
- en: '[PRE14]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Connect to MySQL
  id: totrans-96
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 连接到 MySQL
- en: 'This step is optional, but we use it to verify that we executed all the steps
    correctly. Use this command to connect to the MySQL server:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 这一步骤是可选的，但我们用它来验证我们是否正确执行了所有步骤。使用此命令连接到 MySQL 服务器：
- en: '[PRE15]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'It will prompt for the password of the root user. Type the password and press
    Enter:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 系统将提示输入 root 用户的密码。输入密码并按 Enter：
- en: '[PRE16]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'If successful, it will show the MySQL command line:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功，将显示 MySQL 命令行：
- en: '[PRE17]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Start MySQL 8.0 upon server start (optional)
  id: totrans-103
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: MySQL 8.0 在服务器启动时启动（可选）
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置 MySQL 在服务器启动时启动，请使用以下命令：
- en: '[PRE18]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Installing MariaDB 10.5
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MariaDB 10.5
- en: To install MariaDB 10.5 on CentOS 7, you’ll need to execute similar steps as
    for the vanilla MySQL distribution.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 CentOS 7 上安装 MariaDB 10.5，您需要执行与普通 MySQL 发行版类似的步骤。
- en: Become root in Linux
  id: totrans-108
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中切换为 root 用户
- en: First, we need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要切换为 root 用户。请参阅[“安装 MySQL 8.0”](#MYSQL8_CENTOS7)中的说明。
- en: Install the MariaDB repository
  id: totrans-110
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MariaDB 仓库
- en: 'The following set of commands will download the MariaDB repo and configure
    it for the next step. Note that in the `yum` commands, we are using the `-y` option.
    This option tells Linux to assume the answer is *yes* for all subsequent questions:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 下列一组命令将下载 MariaDB 仓库并配置为下一步的准备。请注意，在 `yum` 命令中，我们使用了 `-y` 选项。此选项告诉 Linux 假设对所有后续问题的回答都是
    *是*：
- en: '[PRE19]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Install MariaDB
  id: totrans-113
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MariaDB
- en: 'With the repository configured, the next command will install the latest stable
    version of MariaDB and its dependencies:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 配置了仓库后，下一个命令将安装 MariaDB 的最新稳定版本及其依赖项：
- en: '[PRE20]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The end of the output will be similar to this:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 输出的结尾将类似于这样：
- en: '[PRE21]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The *Complete!* at the end of the log indicates a successful installation.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 日志末尾的 *Complete!* 表示安装成功。
- en: Start MariaDB
  id: totrans-119
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MariaDB
- en: 'With MariaDB installed, initialize the service with the `systemctl` command:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 MariaDB 后，使用 `systemctl` 命令初始化服务：
- en: '[PRE22]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'You can use this command to verify its status:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用此命令验证其状态：
- en: '[PRE23]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Secure MariaDB
  id: totrans-125
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安全设置 MariaDB。
- en: 'At this point, MariaDB will be running in insecure mode. In contrast to MySQL
    8.0, MariaDB will have an empty root password so you can access it instantly:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，MariaDB 将以不安全模式运行。与 MySQL 8.0 相比，MariaDB 将具有空的 root 密码，因此您可以立即访问它：
- en: '[PRE25]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'You can execute `mysql_secure_installation` to secure MariaDB just like you
    would for MySQL 8.0 (see the previous section for details). There is a slight
    variation in output, with one extra question:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以执行 `mysql_secure_installation` 来安全设置 MariaDB，就像为 MySQL 8.0 做的那样（详细信息请参见前一部分）。输出略有不同，有一个额外的问题：
- en: '[PRE27]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Answering *yes* changes the connection from TCP/IP to Unix socket mode. We will
    discuss the different connection types in [“MySQL 5.7 Default Files”](#MYSQL-SOCKET-TCP).
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 回答 *yes* 将连接从 TCP/IP 更改为 Unix 套接字模式。我们将在 [“MySQL 5.7 默认文件”](#MYSQL-SOCKET-TCP)
    中讨论不同的连接类型。
- en: Installing Percona Server 8.0
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0。
- en: Install Percona Server 8.0 on CentOS 7 using the following step.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 7 上安装 Percona Server 8.0，请按以下步骤操作。
- en: Become root in Linux
  id: totrans-134
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中成为 root 用户。
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。查看 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Install the Percona repository
  id: totrans-136
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona 存储库。
- en: 'You can install the Percona *yum* repository by running the following command
    as root or with `sudo`:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过以下命令作为 root 用户或使用 `sudo` 安装 Percona *yum* 存储库：
- en: '[PRE28]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The installation creates a new repository file, */etc/yum.repos.d/percona-original-release.repo*.
    Now, enable the Percona Server 8.0 repository using this command:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 安装后会创建一个新的存储库文件，*/etc/yum.repos.d/percona-original-release.repo*。现在，使用此命令启用
    Percona Server 8.0 存储库：
- en: '[PRE29]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Install Percona Server 8.0
  id: totrans-141
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0。
- en: 'To install the server, execute this command:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装服务器，请执行此命令：
- en: '[PRE30]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Initialize Percona Server 8.0 with systemctl
  id: totrans-144
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 systemctl 初始化 Percona Server 8.0。
- en: 'Once you’ve installed the Percona Server 8.0 binaries, start the service:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 Percona Server 8.0 二进制文件后，请启动服务：
- en: '[PRE31]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'And validate its status:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 并验证其状态：
- en: '[PRE32]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: At this point, the steps are similar to the vanilla installation. Refer to the
    sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，步骤与原始安装类似。参考 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中有关获取临时密码和执行 `mysql_secure_installation`
    命令的部分。
- en: Installing MySQL 5.7
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7。
- en: Install MySQL 5.7 on CentOS 7 using the following steps.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 7 上安装 MySQL 5.7，请按以下步骤操作。
- en: Become root in Linux
  id: totrans-153
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中成为 root 用户。
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。查看 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Install the MySQL 5.7 repository
  id: totrans-155
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7 存储库。
- en: 'You can install the MySQL 5.7 *yum* repository by running the following command
    as root or with `sudo`:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过以下命令作为 root 用户或使用 `sudo` 安装 MySQL 5.7 *yum* 存储库：
- en: '[PRE34]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: The installation creates a new repository file, */etc/yum.repos.d/mysql-community.repo*.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 安装后会创建一个新的存储库文件，*/etc/yum.repos.d/mysql-community.repo*。
- en: Install the MySQL 5.7 binaries
  id: totrans-159
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7 二进制文件。
- en: 'To install the server, execute this command:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装服务器，请执行此命令：
- en: '[PRE35]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Initialize MySQL 5.7 with systemctl
  id: totrans-162
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 systemctl 初始化 MySQL 5.7。
- en: 'Once you’ve installed the MySQL 5.7 binaries, start the service:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 MySQL 5.7 二进制文件后，请启动服务：
- en: '[PRE36]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'And run this command to validate its status:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 并运行以下命令验证其状态：
- en: '[PRE37]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，步骤与 MySQL 8.0 的原始安装类似。参考 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中有关获取临时密码和执行 `mysql_secure_installation`
    命令的部分。
- en: Installing Percona Server 5.7
  id: totrans-168
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 Percona Server 5.7。
- en: Install Percona Server 5.7 on CentOS 7 using the following steps.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 7 上安装 Percona Server 5.7，请按以下步骤操作。
- en: Become root in Linux
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中成为 root 用户。
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。查看 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Install the Percona repository
  id: totrans-172
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona 存储库。
- en: 'You can install the Percona *yum* repository by running the following command
    as root or with `sudo`:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过以下命令作为 root 用户或使用 `sudo` 安装 Percona *yum* 存储库：
- en: '[PRE38]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The installation creates a new repository file, */etc/yum.repos.d/percona-original-release.repo*.
    Use this command to enable the Percona Server 5.7 repository:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 安装后会创建一个新的存储库文件，*/etc/yum.repos.d/percona-original-release.repo*。使用此命令启用 Percona
    Server 5.7 存储库：
- en: '[PRE39]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Install the Percona Server 5.7 binaries
  id: totrans-177
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona Server 5.7 二进制文件。
- en: 'To install the server, execute this command:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装服务器，请执行此命令：
- en: '[PRE40]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Initialize Percona Server 5.7 with systemctl
  id: totrans-180
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 systemctl 初始化 Percona Server 5.7
- en: 'Once you’ve installed the Percona Server 5.7 binaries, start the service:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您安装了 Percona Server 5.7 二进制文件，请启动服务：
- en: '[PRE41]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'And validate its status:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 并验证其状态：
- en: '[PRE42]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 此时步骤与 MySQL 8.0 原始安装类似。参考获取临时密码并执行 `mysql_secure_installation` 命令的相关章节[“安装 MySQL
    8.0”](#MYSQL8_CENTOS7)。
- en: Installing MySQL on CentOS 8
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 CentOS 8 上安装 MySQL
- en: The current version of CentOS is CentOS 8, and it is built on top of RHEL 8\.
    Typically, CentOS enjoys the same ten-year support lifecycle as RHEL itself. This
    traditional support lifecycle would give CentOS 8 an end-of-life date in 2029\.
    However, in December 2020, a Red Hat announcement signaled the intention to put
    a headstone on CentOS 8’s grave much sooner—in 2021\. (Red Hat will support CentOS
    7 alongside RHEL 7 through 2024.) Current CentOS users will need to migrate either
    to RHEL itself or to the newer CentOS Stream project. Some community projects
    are arising, but at this point, the future of CentOS is uncertain.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 当前版本的 CentOS 是 CentOS 8，基于 RHEL 8 构建。通常，CentOS 享有与 RHEL 自身相同的十年支持生命周期。传统的支持生命周期将使
    CentOS 8 在 2029 年达到生命周期终止日期。然而，2020 年 12 月，Red Hat 的一则公告表明打算更早地终止 CentOS 8——在
    2021 年。（Red Hat 将继续支持 CentOS 7 直至 2024 年与 RHEL 7 并行支持。）当前的 CentOS 用户需要迁移到 RHEL
    本身或更新的 CentOS Stream 项目。尽管一些社区项目正在兴起，但目前 CentOS 的未来仍不明朗。
- en: However, we will share the installation steps here since many users are using
    RHEL 8 and Oracle Linux 8 in the industry.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，我们将在此分享安装步骤，因为行业中许多用户使用的是 RHEL 8 和 Oracle Linux 8。
- en: Installing MySQL 8.0
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MySQL 8.0
- en: The latest MySQL 8.0 version is available to install from the default AppStream
    repository using the MySQL module that the CentOS 8 and RHEL 8 systems enable
    by default. So, there is some variation from the traditional `yum` method. Let’s
    take a look at the details.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 默认的 AppStream 存储库中提供了最新的 MySQL 8.0 版本，可以通过 CentOS 8 和 RHEL 8 系统默认启用的 MySQL 模块进行安装。因此，与传统的
    `yum` 方法有所不同。让我们详细看看。
- en: Become root in Linux
  id: totrans-191
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中成为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。请参阅[“安装 MySQL 8.0”](#MYSQL8_CENTOS7)中的说明。
- en: Install the MySQL 8.0 binaries
  id: totrans-193
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MySQL 8.0 二进制文件
- en: 'Run the following command to install the `mysql-server` package and a number
    of its dependencies:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令安装 `mysql-server` 包及其一些依赖项：
- en: '[PRE43]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示时，按下 **y** 然后按 Enter 确认您希望继续：
- en: '[PRE44]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Start MySQL
  id: totrans-198
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MySQL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    The package you installed configures MySQL to run as a `systemd` service named
    `mysqld.service`. To start MySQL, you need to use the `systemctl` command:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，您已在服务器上安装了 MySQL，但尚未启动。安装的软件包配置 MySQL 以 `systemd` 服务形式运行，服务名称为 `mysqld.service`。要启动
    MySQL，您需要使用 `systemctl` 命令：
- en: '[PRE45]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Check if the service is running
  id: totrans-201
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否运行
- en: 'To check if the service is running correctly, run the following command:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 若要检查服务是否正常运行，请运行以下命令：
- en: '[PRE46]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功启动 MySQL，输出将显示 MySQL 服务处于活动状态：
- en: '[PRE47]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '[PRE48]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Secure MySQL 8.0
  id: totrans-207
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安全设置 MySQL 8.0
- en: As with installing MySQL 8.0 on CentOS 7, you need to execute the `mysql_secure_installation`
    command (see the relevant section in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7)
    for details). The main difference is that there is *not* a temporary password
    for CentOS 8, so when the script requests the root password, leave it blank and
    press Enter.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如在 CentOS 7 上安装 MySQL 8.0 一样，您需要执行 `mysql_secure_installation` 命令（详见[“安装 MySQL
    8.0”](#MYSQL8_CENTOS7)相关部分）。主要区别在于 CentOS 8 没有临时密码，因此当脚本要求输入 root 密码时，请留空并按 Enter
    键。
- en: Start MySQL 8.0 upon server start (optional)
  id: totrans-209
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MySQL 8.0 并随服务器启动（可选）
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 若要在服务器启动时设置 MySQL 自动启动，请使用以下命令：
- en: '[PRE49]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Installing Percona Server 8.0
  id: totrans-212
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0
- en: To install Percona Server 8.0 on CentOS 8, you need to install the repository
    first. Let’s walk through the steps.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 CentOS 8 上安装 Percona Server 8.0，您首先需要安装存储库。我们一起来看看具体步骤。
- en: Become root in Linux
  id: totrans-214
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中成为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。请参阅[“安装 MySQL 8.0”](#MYSQL8_CENTOS7)中的说明。
- en: Install the Percona Server 8.0 binaries
  id: totrans-216
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0 二进制文件
- en: 'Run the following command to install the Percona repository:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令安装 Percona 存储库：
- en: '[PRE50]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示时，按 **y** 然后按 Enter 确认您要继续：
- en: '[PRE51]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Enable the repository for Percona 8.0
  id: totrans-221
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启用 Percona 8.0 存储库
- en: 'The installation creates a new repository file in */etc/yum.repos.d/percona-original-release.repo*.
    Enable the Percona Server 8.0 repository using this command:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 安装会在 */etc/yum.repos.d/percona-original-release.repo* 创建新的存储库文件。使用以下命令启用 Percona
    Server 8.0 存储库：
- en: '[PRE52]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The command prompts you to disable the RHEL 8 module for MySQL. You can do
    this now by pressing **y**:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令会提示您禁用 MySQL 的 RHEL 8 模块。您可以按 **y** 现在执行此操作：
- en: '[PRE53]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Or do it manually with the following command:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 或者使用以下命令手动执行：
- en: '[PRE54]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Install the Percona Server 8.0 binaries
  id: totrans-228
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0 二进制文件
- en: 'You’re now ready to install Percona Server 8.0 on your CentOS 8/RHEL 8 server.
    To avoid being prompted again about whether you want to proceed, add the `-y`
    to the command line:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以在 CentOS 8/RHEL 8 服务器上安装 Percona Server 8.0 了。为了避免再次提示是否要继续，请在命令行中加入 `-y`：
- en: '[PRE55]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Start and secure Percona Server 8.0
  id: totrans-231
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动和安全设置 Percona Server 8.0
- en: 'Now that you’ve installed the Percona Server 8.0 binaries, you can start the
    `mysqld` service and set it to start at system boot:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 Percona Server 8.0 二进制文件后，您可以启动 `mysqld` 服务并设置其在系统启动时启动：
- en: '[PRE56]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Check the service status
  id: totrans-234
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务状态
- en: 'It is important to validate that you’ve completed all the steps successfully.
    Use this command to check the status of the service:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 确认您已成功完成所有步骤非常重要。使用此命令检查服务的状态：
- en: '[PRE57]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '[PRE58]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Tip
  id: totrans-238
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: 'If you ever want to disable the option of MySQL starting up at boot, you can
    do so by running the following command:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想禁用 MySQL 在启动时启动的选项，可以运行以下命令：
- en: '[PRE59]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Installing MySQL 5.7
  id: totrans-241
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7
- en: Install MySQL 5.7 on CentOS 8 using the following steps.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 8 上安装 MySQL 5.7，请按以下步骤操作。
- en: Become root in Linux
  id: totrans-243
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中切换到 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要成为 root 用户。参见 [“Installing MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Disable the MySQL default module
  id: totrans-245
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 禁用 MySQL 默认模块
- en: 'Systems such as RHEL 8, Oracle Linux 8, and CentOS 8 enable the MySQL module
    by default. Unless this module is disabled, it masks packages provided by MySQL
    repositories, preventing you from installing a version different than MySQL 8.0\.
    So, use these commands to remove this default module:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: RHEL 8、Oracle Linux 8 和 CentOS 8 等系统默认启用 MySQL 模块。除非禁用此模块，否则会屏蔽 MySQL 存储库提供的软件包，防止安装与
    MySQL 8.0 不同版本的软件包。因此，请使用以下命令移除此默认模块：
- en: '[PRE60]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: Configure the MySQL 5.7 repository
  id: totrans-248
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置 MySQL 5.7 存储库
- en: 'There is no MySQL repository for CentOS 8, so we’ll use the CentOS 7 repository
    instead as a reference. Create a new repository file:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: CentOS 8 没有 MySQL 存储库，因此我们将参考 CentOS 7 存储库作为参考。创建新的存储库文件：
- en: '[PRE61]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'And paste the following data into the file:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 并将以下数据粘贴到文件中：
- en: '[PRE62]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Install the MySQL 5.7 binaries
  id: totrans-253
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7 二进制文件
- en: 'With the default module disabled and the repository configured, run the following
    command to install the `mysql-server` package and its dependencies:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 禁用默认模块并配置存储库后，请运行以下命令安装 `mysql-server` 包及其依赖项：
- en: '[PRE63]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示时，按 **y** 然后按 Enter 确认您要继续：
- en: '[PRE64]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: Start MySQL
  id: totrans-258
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MySQL
- en: 'You’ve installed the MySQL binaries on your server, but it isn’t yet operational.
    The package you installed configures MySQL to run as a `systemd` service named
    `mysqld.service`. To start MySQL, you need to use the `systemctl` command:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 您已在服务器上安装了 MySQL 二进制文件，但尚未运行。您安装的软件包配置了 MySQL 以 `systemd` 服务 `mysqld.service`
    的形式运行。要启动 MySQL，您需要使用 `systemctl` 命令：
- en: '[PRE65]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Check if the service is running
  id: totrans-261
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否正在运行
- en: 'To check that the service is running correctly, run the following command:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查服务是否正常运行，请运行以下命令：
- en: '[PRE66]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功启动 MySQL，则输出将显示 MySQL 服务处于活动状态：
- en: '[PRE67]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '[PRE68]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: Secure MySQL 5.7
  id: totrans-267
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安全安装 MySQL 5.7
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 此时的步骤类似于 MySQL 8.0 的普通安装。请参阅获取临时密码和在 [“Installing MySQL 8.0”](#MYSQL8_CENTOS7)
    中执行 `mysql_secure_installation` 命令的部分。
- en: Start MySQL 5.7 upon server start (optional)
  id: totrans-269
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在服务器启动时启动 MySQL 5.7（可选）
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置 MySQL 在服务器启动时启动，使用以下命令：
- en: '[PRE69]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: Installing MySQL on Ubuntu 20.04 LTS (Focal Fossa)
  id: totrans-272
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Ubuntu 20.04 LTS（Focal Fossa）上安装 MySQL
- en: '[Ubuntu](https://ubuntu.com) is a Linux distribution based on Debian that is
    composed mostly of free and open source software. Officially, there are three
    Ubuntu editions: Desktop, Server, and Core for IoT devices and robots. The version
    we will work with in this book is the Server version.'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '[Ubuntu](https://ubuntu.com) 是基于 Debian 的 Linux 发行版，主要由自由开源软件组成。官方上有三个 Ubuntu
    版本：桌面版、服务器版和面向物联网设备和机器人的 Core 版本。本书使用的版本是服务器版。'
- en: Installing MySQL 8.0
  id: totrans-274
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MySQL 8.0
- en: For Ubuntu, the process is slightly different since Ubuntu uses the *apt* repository.
    Let’s walk through the steps.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Ubuntu，过程略有不同，因为 Ubuntu 使用 *apt* 软件包仓库。我们来看看具体步骤。
- en: Become root in Linux
  id: totrans-276
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 下成为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，你需要成为 root 用户。请查看 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Configure the apt repository
  id: totrans-278
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置 apt 仓库
- en: 'On Ubuntu 20.04 (Focal Fossa), you can install MySQL using the *apt* package
    repository. First, ensure that your system is up-to-date:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Ubuntu 20.04（Focal Fossa）上，你可以使用 *apt* 软件包仓库安装 MySQL。首先确保你的系统是最新的：
- en: '[PRE70]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: Install MySQL 8.0
  id: totrans-281
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MySQL 8.0
- en: 'Next, install the `mysql-server` package:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，安装 `mysql-server` 软件包：
- en: '[PRE71]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: The `apt install` command will install MySQL but won’t prompt you to set a password
    or make any other configuration changes. Unlike the CentOS installation, Ubuntu
    initializes MySQL in *insecure mode*.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '`apt install` 命令会安装 MySQL，但不会提示你设置密码或进行其他配置更改。与 CentOS 安装不同，Ubuntu 在 *不安全模式*
    下初始化 MySQL。'
- en: For fresh installations of MySQL, you’ll want to run the database management
    system’s (DBMS’s) included security script. This script changes some of the less
    secure default options for remote root logins and the test database. We will address
    this problem in the securing step after initializing MySQL.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 MySQL 的新安装，你需要运行数据库管理系统（DBMS）附带的安全脚本。该脚本会更改一些默认的不安全选项，如远程 root 登录和测试数据库。我们将在初始化
    MySQL 后的安全配置步骤中解决这个问题。
- en: Start MySQL
  id: totrans-286
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MySQL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    To start MySQL, you need to use the `systemctl` command:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，你已在服务器上安装了 MySQL，但还没有启动。要启动 MySQL，你需要使用 `systemctl` 命令：
- en: '[PRE72]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: Check if the service is running
  id: totrans-289
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否正在运行
- en: 'To check that the service is running correctly, run the following command:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查服务是否正常运行，请运行以下命令：
- en: '[PRE73]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 如果成功启动 MySQL，则输出将显示 MySQL 服务处于活动状态。
- en: '[PRE74]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Secure MySQL 8.0
  id: totrans-294
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安全配置 MySQL 8.0
- en: 'At this point, the steps are similar to the vanilla installation on CentOS
    7 (see [“Installing MySQL 8.0”](#MYSQL8_CENTOS7)). However, MySQL 8.0 on Ubuntu
    is initialized unsecured, which means the root password is empty. To secure it,
    execute `mysql_secure_installation`:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，步骤与 CentOS 7 上的普通安装类似（参见 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7)）。然而，Ubuntu 上的
    MySQL 8.0 是未安全化的，这意味着 root 密码为空。要将其安全化，请执行 `mysql_secure_installation`：
- en: '[PRE75]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: This will take you through a series of prompts to make some changes to the MySQL
    installation’s security options, which are similar to those of the CentOS version
    as described earlier.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 这将引导你通过一系列提示，对 MySQL 安装的安全选项进行一些更改，与之前描述的 CentOS 版本类似。
- en: 'There is a small variance here because in Ubuntu it is possible to change the
    validation policy, which manages password strength. In this example, we are setting
    the validation policy to MEDIUM (1):'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个小变化，因为在 Ubuntu 中可以更改验证策略，管理密码强度。在这个例子中，我们将验证策略设置为 MEDIUM（1）：
- en: '[PRE76]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: Installing Percona Server 8
  id: totrans-300
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8
- en: Install Percona Server 8.0 on Ubuntu 20.04 LTS using the following steps.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下步骤在 Ubuntu 20.04 LTS 上安装 Percona Server 8.0。
- en: Become root in Linux
  id: totrans-302
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 下成为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，你需要成为 root 用户。请查看 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Install the GNU Privacy Guard
  id: totrans-304
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 GNU 隐私保护
- en: 'Oracle signs MySQL downloadable packages with GNU Privacy Guard (GnuPG), an
    open source alternative to the well-known Pretty Good Privacy (PGP) created by
    Phil Zimmermann. Most Linux distributions ship with GnuPG installed by default,
    but in this case you need to install it:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: Oracle 使用 GNU 隐私保护（GnuPG）对 MySQL 可下载包进行签名，这是一个由 Phil Zimmermann 创造的开源替代方案，类似于广为人知的
    Pretty Good Privacy（PGP）。大多数 Linux 发行版默认安装了 GnuPG，但在这种情况下，你需要安装它：
- en: '[PRE77]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: Fetch the repository packages from the Percona website
  id: totrans-307
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 从 Percona 网站获取存储库包
- en: 'Next, fetch the repository packages from the Percona repository with the `wget`
    command:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用 `wget` 命令从 Percona 存储库获取存储库包：
- en: '[PRE78]'
  id: totrans-309
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: Install the downloaded package with dpkg
  id: totrans-310
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 dpkg 安装下载的软件包
- en: 'Once downloaded, install the package with the following command:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 下载完成后，请使用以下命令安装软件包：
- en: '[PRE79]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: You can then check the repository configured in the */etc/apt/sources.list.d/percona-original-release.list*
    file.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，您可以检查配置在 */etc/apt/sources.list.d/percona-original-release.list* 文件中的存储库。
- en: Enable the repository
  id: totrans-314
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启用存储库
- en: 'The next step is enabling Percona Server 8.0 in the repository and refreshing
    it:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是在存储库中启用 Percona Server 8.0 并刷新：
- en: '[PRE80]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: Install the Percona Server 8.0 binaries
  id: totrans-317
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 Percona Server 8.0 二进制文件
- en: 'Then, install the `percona-server-server` package with the `apt-get install`
    command:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用 `apt-get install` 命令安装 `percona-server-server` 软件包：
- en: '[PRE81]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: Start MySQL
  id: totrans-320
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 启动 MySQL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    To start MySQL, you need to use the `systemctl` command:'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，您已在服务器上安装了 MySQL，但尚未启动。要启动 MySQL，需要使用 `systemctl` 命令：
- en: '[PRE82]'
  id: totrans-322
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: Check if the service is running
  id: totrans-323
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否正在运行
- en: 'To check that the service is running correctly, run the following command:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查服务是否正常运行，请运行以下命令：
- en: '[PRE83]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: At this point, Percona Server will be running in insecure mode. Executing `mysql_secure_installation`
    will take you through a series of prompts to make some changes to your MySQL installation’s
    security options, which are identical to those described for installing vanilla
    MySQL 8.0 in the previous section.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，Percona Server 将以不安全模式运行。执行 `mysql_secure_installation` 将引导您通过一系列提示，对 MySQL
    安装的安全选项进行更改，这与前面在本节中安装原始 MySQL 8.0 的描述相同。
- en: Installing MariaDB 10.5
  id: totrans-327
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MariaDB 10.5
- en: Install MariaDB 10.5 on Ubuntu 20.04 LTS using the following steps.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下步骤在 Ubuntu 20.04 LTS 上安装 MariaDB 10.5。
- en: Become root in Linux
  id: totrans-329
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中切换为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要切换为 root 用户。请参阅 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Update the system with the apt package manager
  id: totrans-331
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 apt 包管理器更新系统
- en: 'Ensure your system is up-to-date and install the `software-properties-common`
    package with the following commands:'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 确保您的系统已经更新，并使用以下命令安装 `software-properties-common` 软件包：
- en: '[PRE84]'
  id: totrans-333
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: This package contains the common files for software properties like the D-Bus
    backend and an abstraction of the used *apt* repositories.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 此软件包包含用于软件属性的公共文件，如 D-Bus 后端和所使用 *apt* 存储库的抽象。
- en: Import the MariaDB GPG key
  id: totrans-335
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 导入 MariaDB 的 GPG 密钥
- en: 'Run the following command to add the repository key to the system:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令将存储库密钥添加到系统：
- en: '[PRE85]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: Add the MariaDB repository
  id: totrans-338
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 添加 MariaDB 存储库
- en: 'After importing the repository GPG key, you need to add the *apt* repository
    by running the following command:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 导入存储库 GPG 密钥后，您需要运行以下命令添加 *apt* 存储库：
- en: '[PRE86]'
  id: totrans-340
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: Note
  id: totrans-341
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: There are different mirrors to download the MariaDB repository. In this example,
    we use *[*http://mariadb.mirror.globo.tech*](http://mariadb.mirror.globo.tech)*.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 有不同的镜像可以下载 MariaDB 存储库。在本例中，我们使用 *[*http://mariadb.mirror.globo.tech*](http://mariadb.mirror.globo.tech)*。
- en: Install the MariaDB 10.5 binaries
  id: totrans-343
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装 MariaDB 10.5 二进制文件
- en: 'The next step is the installation of the MariaDB Server:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是安装 MariaDB Server：
- en: '[PRE87]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: Check if the service is running
  id: totrans-346
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否正在运行
- en: 'To check if the MariaDB service is running correctly, run the following command:'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查 MariaDB 服务是否正常运行，请运行以下命令：
- en: '[PRE88]'
  id: totrans-348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: At this point, MariaDB 10.5 will be running in insecure mode. Executing `mysql_secure_installation`
    will take you through a series of prompts to make some changes to your MySQL installation’s
    security options, which are identical to those described for installing vanilla
    MySQL 8.0 on Ubuntu earlier in this section.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，MariaDB 10.5 将以不安全模式运行。执行 `mysql_secure_installation` 将引导您通过一系列提示，对 MySQL
    安装的安全选项进行更改，这与前面在本节中安装原始 MySQL 8.0 的描述相同。
- en: Installing MySQL 5.7
  id: totrans-350
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 MySQL 5.7
- en: Install MySQL 5.7 on Ubuntu 20.04 LTS using the following steps.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下步骤在 Ubuntu 20.04 LTS 上安装 MySQL 5.7。
- en: Become root in Linux
  id: totrans-352
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 在 Linux 中切换为 root 用户
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您需要切换为 root 用户。请参阅 [“安装 MySQL 8.0”](#MYSQL8_CENTOS7) 中的说明。
- en: Update the system with the apt package manager
  id: totrans-354
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 apt 包管理器更新系统
- en: 'You can ensure your system is updated and install the `software-properties-common`
    package with the following command:'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以确保系统已更新，并使用以下命令安装 `software-properties-common` 软件包：
- en: '[PRE89]'
  id: totrans-356
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: Add and configure the MySQL 5.7 repository
  id: totrans-357
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 添加和配置MySQL 5.7存储库
- en: 'Add the MySQL repository by running the following commands:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 通过运行以下命令添加MySQL存储库：
- en: '[PRE90]'
  id: totrans-359
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: At the prompt, choose “ubuntu bionic” as shown in [Figure 1-1](#FIG-MYSQL-BIONIC)
    and click OK.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示符下，选择“ubuntu bionic”，如[图 1-1](#FIG-MYSQL-BIONIC)所示，并点击“确定”。
- en: '![lm2e 0101](Images/lm2e_0101.png)'
  id: totrans-361
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0101](Images/lm2e_0101.png)'
- en: Figure 1-1\. Choose “ubuntu bionic”
  id: totrans-362
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-1\. 选择“ubuntu bionic”
- en: The next prompt shows MySQL 8.0 chosen by default ([Figure 1-2](#FIG-MYSQL-OPTION)).
    With this option selected, press Enter.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个提示显示MySQL 8.0默认选择（[图 1-2](#FIG-MYSQL-OPTION)）。选择此选项后，按Enter键。
- en: '![lm2e 0102](Images/lm2e_0102.png)'
  id: totrans-364
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0102](Images/lm2e_0102.png)'
- en: Figure 1-2\. Choose the MySQL Server & Cluster option
  id: totrans-365
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-2\. 选择MySQL Server & Cluster选项
- en: For the next option, as shown in [Figure 1-3](#FIG-MYSQL57-OPTION), choose MySQL
    5.7 and click OK.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 作为下一步选项，如[图 1-3](#FIG-MYSQL57-OPTION)所示，选择MySQL 5.7并点击“确定”。
- en: '![lm2e 0103](Images/lm2e_0103.png)'
  id: totrans-367
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0103](Images/lm2e_0103.png)'
- en: Figure 1-3\. Choose the MySQL 5.7 option
  id: totrans-368
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-3\. 选择MySQL 5.7选项
- en: After returning to the main screen, click OK to exit, as shown in [Figure 1-4](#FIG-MYSQL-OK).
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到主屏幕后，点击“确定”退出，如[图 1-4](#FIG-MYSQL-OK)所示。
- en: '![lm2e 0104](Images/lm2e_0104.png)'
  id: totrans-370
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0104](Images/lm2e_0104.png)'
- en: Figure 1-4\. Click OK to exit
  id: totrans-371
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-4\. 点击“确定”退出
- en: 'Next, you need to update the MySQL packages:'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，需要更新MySQL软件包：
- en: '[PRE91]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'Validate the Ubuntu policy to install MySQL 5.7:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 验证Ubuntu策略以安装MySQL 5.7：
- en: '[PRE92]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'Check the output to see which MySQL 5.7 version is available:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 检查输出，查看可用的MySQL 5.7版本：
- en: '[PRE93]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: '[PRE94]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: Install the MySQL 5.7 binaries
  id: totrans-379
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 安装MySQL 5.7二进制文件
- en: 'Now that you’ve verified that the MySQL 5.7 version is available (*5.7.33-1ubuntu18.04*),
    install it:'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经验证了MySQL 5.7版本可用（*5.7.33-1ubuntu18.04*），请安装它：
- en: '[PRE95]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: The installation process will prompt you to choose the root password, as shown
    in [Figure 1-5](#FIG-MYSQL-ROOT-PASS).
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程将提示您选择root密码，如[图 1-5](#FIG-MYSQL-ROOT-PASS)所示。
- en: '![lm2e 0105](Images/lm2e_0105.png)'
  id: totrans-383
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0105](Images/lm2e_0105.png)'
- en: Figure 1-5\. Define the root password and click OK
  id: totrans-384
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-5\. 定义root密码并点击确定
- en: Check if the service is running
  id: totrans-385
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 检查服务是否正在运行
- en: 'To check if the MySQL 5.7 service is running correctly, run the following command:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查MySQL 5.7服务是否正常运行，请运行以下命令：
- en: '[PRE96]'
  id: totrans-387
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: At this point, MySQL 5.7 will have a password set for the root user. However,
    you’ll still want to run `mysql_secure_installation` to set the password policy,
    remove remote root login and anonymous users, and remove the test database. Refer
    [“Secure MySQL 8.0”](#secmysql8) for details.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，MySQL 5.7将为root用户设置密码。但是，您仍然需要运行`mysql_secure_installation`来设置密码策略，删除远程root登录和匿名用户，并删除测试数据库。详细信息请参见[“安全MySQL
    8.0”](#secmysql8)。
- en: Installing MySQL on macOS Big Sur
  id: totrans-389
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在macOS Big Sur上安装MySQL
- en: MySQL for macOS is available in a few different forms. Since most of the time
    MySQL is installed on macOS for development purposes, we will demonstrate only
    how to install it using the native macOS installer (the *.dmg* file). Be aware
    that it is also possible to use the tarball to install MySQL on macOS.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: macOS的MySQL有几种不同的形式。由于大多数情况下，macOS上安装MySQL用于开发目的，我们只演示如何使用本机macOS安装程序（*.dmg*文件）来安装。请注意，也可以使用tarball在macOS上安装MySQL。
- en: Installing MySQL 8
  id: totrans-391
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装MySQL 8
- en: First, download the MySQL *.dmg* file from the [MySQL website](https://oreil.ly/Ea6Dk).
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，从[MySQL网站](https://oreil.ly/Ea6Dk)下载MySQL的*.dmg*文件。
- en: Tip
  id: totrans-393
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: According to Oracle, macOS Catalina packages work for Big Sur.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 根据Oracle，macOS Catalina软件包适用于Big Sur。
- en: Once downloaded, execute the package to start the install procedure, as shown
    in [Figure 1-6](#FIG-DMG-PACKAGE).
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 下载完成后，执行安装程序来开始安装过程，如[图 1-6](#FIG-DMG-PACKAGE)所示。
- en: '![lm2e 0106](Images/lm2e_0106.png)'
  id: totrans-396
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0106](Images/lm2e_0106.png)'
- en: Figure 1-6\. MySQL 8.0.23 *.dmg* package
  id: totrans-397
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-6\. MySQL 8.0.23 *.dmg*软件包
- en: Next, you need to authorize MySQL to run, as shown in [Figure 1-7](#FIG-DMG-AUTH-REQUEST).
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，需要授权MySQL运行，如[图 1-7](#FIG-DMG-AUTH-REQUEST)所示。
- en: '![lm2e 0107](Images/lm2e_0107.png)'
  id: totrans-399
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0107](Images/lm2e_0107.png)'
- en: Figure 1-7\. MySQL 8.0.23 authorization request
  id: totrans-400
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-7\. MySQL 8.0.23授权请求
- en: '[Figure 1-8](#FIG-INTRO) shows the installer’s welcome screen.'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 1-8](#FIG-INTRO)显示安装程序的欢迎屏幕。'
- en: '![lm2e 0108](Images/lm2e_0108.png)'
  id: totrans-402
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0108](Images/lm2e_0108.png)'
- en: Figure 1-8\. MySQL 8.0.23 initial screen
  id: totrans-403
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-8\. MySQL 8.0.23初始屏幕
- en: '[Figure 1-9](#FIG-LICENSE) shows the license agreement. Even with open source
    software, it is necessary to agree to the license terms; otherwise, you can’t
    proceed.'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 1-9](#FIG-LICENSE)显示许可协议。即使是开源软件，也需要同意许可条款，否则无法继续。'
- en: '![lm2e 0109](Images/lm2e_0109.png)'
  id: totrans-405
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0109](Images/lm2e_0109.png)'
- en: Figure 1-9\. MySQL 8.0.23 license agreement
  id: totrans-406
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-9\. MySQL 8.0.23许可协议
- en: Now you can define the location and customize the installation, as shown in
    [Figure 1-10](#FIG-INSTALL-OPTS).
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你可以定义安装的位置并自定义安装，如 [图 1-10](#FIG-INSTALL-OPTS) 所示。
- en: '![lm2e 0110](Images/lm2e_0110.png)'
  id: totrans-408
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0110](Images/lm2e_0110.png)'
- en: Figure 1-10\. MySQL 8.0.23 installation customization
  id: totrans-409
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-10\. MySQL 8.0.23 安装自定义
- en: You are going to proceed with the standard installation. After clicking Install,
    you might get prompted to enter the macOS user password to run the installation
    with higher privileges, as [Figure 1-11](#FIG-MACOS-AUTH) shows.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 你将继续标准安装。点击安装后，可能需要输入 macOS 用户密码以使用更高权限运行安装，如 [图 1-11](#FIG-MACOS-AUTH) 所示。
- en: '![lm2e 0111](Images/lm2e_0111.png)'
  id: totrans-411
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0111](Images/lm2e_0111.png)'
- en: Figure 1-11\. macOS authorization request
  id: totrans-412
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-11\. macOS 授权请求
- en: Once you’ve installed MySQL, the installation process will prompt you to choose
    the *password encryption*. You should use the newer authentication method (the
    default option), as shown in [Figure 1-12](#FIG-MACOS-SEC), which is safer.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 MySQL 后，安装过程会提示你选择 *密码加密*。你应该使用更新的认证方法（默认选项），如 [图 1-12](#FIG-MACOS-SEC) 所示，这更安全。
- en: '![lm2e 0112](Images/lm2e_0112.png)'
  id: totrans-414
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0112](Images/lm2e_0112.png)'
- en: Figure 1-12\. MySQL 8.0.23 password encryption
  id: totrans-415
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-12\. MySQL 8.0.23 密码加密
- en: The last step consists of creating the root password and initializing MySQL,
    as shown in [Figure 1-13](#FIG-MACOS-ROOT-PASS).
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是创建根密码并初始化 MySQL，如 [图 1-13](#FIG-MACOS-ROOT-PASS) 所示。
- en: '![lm2e 0113](Images/lm2e_0113.png)'
  id: totrans-417
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0113](Images/lm2e_0113.png)'
- en: Figure 1-13\. MySQL 8.0.23 root password
  id: totrans-418
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-13\. MySQL 8.0.23 根密码
- en: You’ve now installed MySQL Server, but it is not loaded (or started) by default.
    To start, open System Preferences and search for the MySQL icon, as shown in [Figure 1-14](#FIG-MACOS-MYSQL-ICON).
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经安装了 MySQL 服务器，但默认情况下没有加载（或启动）。要启动，请打开系统偏好设置并搜索 MySQL 图标，如 [图 1-14](#FIG-MACOS-MYSQL-ICON)
    所示。
- en: '![lm2e 0114](Images/lm2e_0114.png)'
  id: totrans-420
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0114](Images/lm2e_0114.png)'
- en: Figure 1-14\. MySQL in System Preferences
  id: totrans-421
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-14\. 系统偏好设置中的 MySQL
- en: Click the icon to open the MySQL panel. You should see something similar to
    [Figure 1-15](#FIG-MACOS-MYSQL-START-OPT).
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 点击图标打开 MySQL 面板。你应该看到类似于 [图 1-15](#FIG-MACOS-MYSQL-START-OPT) 的界面。
- en: '![lm2e 0115](Images/lm2e_0115.png)'
  id: totrans-423
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0115](Images/lm2e_0115.png)'
- en: Figure 1-15\. MySQL start options
  id: totrans-424
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-15\. MySQL 启动选项
- en: Besides the obvious option, which is to start the MySQL process, there is a
    configuration panel (with the location of the MySQL files) and an option to reinitialize
    the database (you already initialized it during the installation). Start the MySQL
    process. You might be asked for the administrator password again.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 除了明显的选项（即启动 MySQL 进程），还有一个配置面板（显示 MySQL 文件的位置）和重新初始化数据库的选项（你已经在安装过程中初始化了）。启动
    MySQL 进程时可能会再次要求管理员密码。
- en: 'With MySQL running, it is possible to validate the connection and confirm that
    MySQL Server is running correctly. You can use [MySQL Workbench](https://oreil.ly/RVWbe)
    to test this, or install the MySQL client using `brew`:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 运行后，可以验证连接并确认 MySQL 服务器是否正确运行。你可以使用 [MySQL Workbench](https://oreil.ly/RVWbe)
    进行测试，或者使用 `brew` 安装 MySQL 客户端：
- en: '[PRE97]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'Once you’ve installed the MySQL client, you can connect with the password you
    defined in [Figure 1-13](#FIG-MACOS-ROOT-PASS). In the terminal, run the following
    command:'
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 MySQL 客户端后，你可以使用在 [图 1-13](#FIG-MACOS-ROOT-PASS) 中定义的密码连接。在终端中运行以下命令：
- en: '[PRE98]'
  id: totrans-429
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: '[PRE99]'
  id: totrans-430
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: '[PRE100]'
  id: totrans-431
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: Installing MySQL on Windows 10
  id: totrans-432
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Windows 10 上安装 MySQL
- en: Oracle provides a [MySQL Installer for Windows](https://oreil.ly/N4enF) to facilitate
    the installation. Note that MySQL Installer is a 32-bit application, but it can
    install MySQL in 32-bit and 64-bit binaries. To initiate the installation process,
    you need to execute the installer file and choose the type of installation, as
    shown in [Figure 1-16](#FIG-WINDOWS-INSTALL-OPTS).
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: Oracle 为 Windows 提供了一个 [MySQL 安装程序](https://oreil.ly/N4enF) 来简化安装过程。请注意，MySQL
    安装程序是一个 32 位应用程序，但可以安装 32 位和 64 位的 MySQL 二进制文件。要启动安装过程，你需要执行安装程序文件并选择安装类型，如 [图 1-16](#FIG-WINDOWS-INSTALL-OPTS)
    所示。
- en: Choose the Developer Default setup type and click Next. We won’t go into detail
    on the other options because we don’t recommend using MySQL for production systems,
    mainly because the MySQL ecosystem is developed for Linux.
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 选择开发者默认设置类型并点击下一步。我们不会详细介绍其他选项，因为我们不建议在生产系统中使用 MySQL，主要是因为 MySQL 生态系统是为 Linux
    开发的。
- en: '![lm2e 0116](Images/lm2e_0116.png)'
  id: totrans-435
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0116](Images/lm2e_0116.png)'
- en: Figure 1-16\. MySQL 8.0.23 Windows installation customization
  id: totrans-436
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1-16\. MySQL 8.0.23 Windows 安装自定义
- en: Next, the installer checks whether all the requirements are satisfied ([Figure 1-17](#FIG-WINDOWS-INSTALL-REQS)).
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，安装程序检查是否满足所有要求（[图 1-17](#FIG-WINDOWS-INSTALL-REQS)）。
- en: '![lm2e 0117](Images/lm2e_0117.png)'
  id: totrans-438
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0117](Images/lm2e_0117.png)'
- en: Figure 1-17\. Installation requirements
  id: totrans-439
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-17\. 安装要求
- en: Click Execute. It might be necessary to install Microsoft Visual C++ ([Figure 1-18](#FIG-WINDOWS-INSTALL-VISUALC)).
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“执行”。可能需要安装Microsoft Visual C++（[图 1-18](#FIG-WINDOWS-INSTALL-VISUALC)）。
- en: '![lm2e 0118](Images/lm2e_0118.png)'
  id: totrans-441
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0118](Images/lm2e_0118.png)'
- en: Figure 1-18\. Install Microsoft Visual C++ if required
  id: totrans-442
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-18\. 如果需要，请安装Microsoft Visual C++
- en: Click Next, and the installer will show the products that are ready to install
    ([Figure 1-19](#FIG-WINDOWS-INSTALL-READY)).
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“下一步”，安装程序将显示准备安装的产品（[图 1-19](#FIG-WINDOWS-INSTALL-READY)）。
- en: '![lm2e 0119](Images/lm2e_0119.png)'
  id: totrans-444
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0119](Images/lm2e_0119.png)'
- en: Figure 1-19\. Click Execute to install the MySQL software
  id: totrans-445
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-19\. 单击“执行”安装MySQL软件
- en: Click Execute and you will arrive at the screen where you can configure MySQL
    properties. You can use the default settings for TCP/IP and the X Protocol port,
    as shown in [Figure 1-20](#FIG-WINDOWS-INSTALL-CFG), or you can customize them
    if you like.
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“执行”，您将进入配置MySQL属性的界面。您可以使用TCP/IP和X协议端口的默认设置，如[图 1-20](#FIG-WINDOWS-INSTALL-CFG)所示，或者根据需要自定义它们。
- en: Next, you will choose the authentication method. Select the newer version that
    is more secure, as shown in [Figure 1-21](#FIG-WINDOWS-INSTALL-AUTH).
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您将选择认证方法。选择更安全的新版本，如[图 1-21](#FIG-WINDOWS-INSTALL-AUTH)所示。
- en: '![lm2e 0120](Images/lm2e_0120.png)'
  id: totrans-448
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0120](Images/lm2e_0120.png)'
- en: Figure 1-20\. Type and networking configuration options
  id: totrans-449
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-20\. 类型和网络配置选项
- en: '![lm2e 0121](Images/lm2e_0121.png)'
  id: totrans-450
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0121](Images/lm2e_0121.png)'
- en: Figure 1-21\. Password encryption—use SHA-256 based passwords
  id: totrans-451
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-21\. 密码加密—使用基于SHA-256的密码
- en: Next, specify the root user password and whether you want to add additional
    users to the MySQL database, as shown in [Figure 1-22](#FIG-WINDOWS-INSTALL-ADD-USER).
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，指定根用户密码以及是否要向MySQL数据库添加额外用户，如[图 1-22](#FIG-WINDOWS-INSTALL-ADD-USER)所示。
- en: '![lm2e 0122](Images/lm2e_0122.png)'
  id: totrans-453
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0122](Images/lm2e_0122.png)'
- en: Figure 1-22\. Configuring users
  id: totrans-454
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-22\. 配置用户
- en: With the users configured, define the service name and user that will run the
    service, as shown in [Figure 1-23](#FIG-WINDOWS-INSTALL-SERVICE).
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 配置用户后，定义将运行服务的服务名和用户，如[图 1-23](#FIG-WINDOWS-INSTALL-SERVICE)所示。
- en: '![lm2e 0123](Images/lm2e_0123.png)'
  id: totrans-456
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0123](Images/lm2e_0123.png)'
- en: Figure 1-23\. Configuring the service name
  id: totrans-457
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-23\. 配置服务名
- en: When you click Next, the installer begins configuring MySQL. Once the MySQL
    installer finishes its execution, you should see something like [Figure 1-24](#FIG-WINDOWS-INSTALL-COMPLETE).
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“下一步”后，安装程序开始配置MySQL。一旦MySQL安装程序执行完成，您应该会看到类似[图 1-24](#FIG-WINDOWS-INSTALL-COMPLETE)的界面。
- en: '![lm2e 0124](Images/lm2e_0124.png)'
  id: totrans-459
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0124](Images/lm2e_0124.png)'
- en: Figure 1-24\. If the installation went fine, there are no errors
  id: totrans-460
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-24\. 如果安装顺利，将没有错误
- en: Now your database server is operational. Since you selected the Developer profile,
    the installer will go through the MySQL Router installation. MySQL Router isn’t
    essential for this setup, and since we don’t recommend Windows for production,
    we’ll skip this part. We will dive into the details of the router in [“MySQL Router”](ch15.xhtml#MYSQL_ROUTER).
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您的数据库服务器已经可操作。由于您选择了开发人员配置文件，安装程序将执行MySQL Router安装。对于此设置，MySQL Router并不是必需的，而且由于我们不建议在生产环境中使用Windows，我们将跳过这一部分。我们将在[“MySQL
    Router”](ch15.xhtml#MYSQL_ROUTER)中深入探讨路由器的细节。
- en: Now you can validate your server using [MySQL Workbench](https://oreil.ly/RVWbe),
    as shown in [Figure 1-25](#FIG-WINDOWS-WORKBENCH-INTRO). You should see a MySQL
    connection option.
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您可以使用[MySQL Workbench](https://oreil.ly/RVWbe)，如[图 1-25](#FIG-WINDOWS-WORKBENCH-INTRO)所示验证您的服务器。您应该会看到一个MySQL连接选项。
- en: '![lm2e 0125](Images/lm2e_0125.png)'
  id: totrans-463
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0125](Images/lm2e_0125.png)'
- en: Figure 1-25\. The MySQL connection option in MySQL Workbench
  id: totrans-464
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-25\. MySQL Workbench中的MySQL连接选项
- en: Double-click the connection and Workbench will prompt you to input the password,
    as shown in [Figure 1-26](#FIG-WINDOWS-WORKBENCH-PASSWORD).
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 双击连接，Workbench将提示您输入密码，如[图 1-26](#FIG-WINDOWS-WORKBENCH-PASSWORD)所示。
- en: '![lm2e 0126](Images/lm2e_0126.png)'
  id: totrans-466
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0126](Images/lm2e_0126.png)'
- en: Figure 1-26\. Enter the root password to connect
  id: totrans-467
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-26\. 输入根密码进行连接
- en: You can now start using MySQL in your Windows platform, as shown in [Figure 1-27](#FIG-WINDOWS-WORKBENCH-CHECKING).
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以在您的Windows平台上开始使用MySQL，如[图 1-27](#FIG-WINDOWS-WORKBENCH-CHECKING)所示。
- en: '![lm2e 0127](Images/lm2e_0127.png)'
  id: totrans-469
  prefs: []
  type: TYPE_IMG
  zh: '![lm2e 0127](Images/lm2e_0127.png)'
- en: Figure 1-27\. You can now begin testing your environment
  id: totrans-470
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 1-27\. 您现在可以开始测试您的环境
- en: The Contents of the MySQL Directory
  id: totrans-471
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MySQL目录的内容
- en: 'During the installation process, MySQL creates all the files that are needed
    to start the server. MySQL stores its files under a directory called the *data
    directory*. Database administrators (DBAs) commonly refer to this as the *datadir*,
    which is the name of the MySQL parameter that stores the path to this directory.
    The default location for Linux distributions is */var/lib/mysql*. You can check
    its location by running the following command in the MySQL instance:'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装过程中，MySQL会创建启动服务器所需的所有文件。MySQL将其文件存储在名为*数据目录*的目录下。数据库管理员（DBA）通常称其为*datadir*，这是存储该目录路径的MySQL参数名称。Linux发行版的默认位置是*/var/lib/mysql*。您可以通过在MySQL实例中运行以下命令来检查其位置：
- en: '[PRE101]'
  id: totrans-473
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: '[PRE102]'
  id: totrans-474
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: MySQL 5.7 Default Files
  id: totrans-475
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MySQL 5.7默认文件
- en: 'The following list briefly describes the files and subdirectories typically
    found in the data directory:'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表简要描述了数据目录中通常找到的文件和子目录：
- en: The REDO log files
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: REDO日志文件
- en: MySQL creates the redo log files as *ib_logfile0* and *ib_logfile1* in the data
    directory. It writes to the redo log files in a circular fashion, so the files
    do not grow beyond their configuration size (configured by [`innodb_log_file_size`](https://oreil.ly/XRzLb)).
    As in any other relational database management system (RDBMS) that is ACID-compliant,
    the redo files are fundamental to provide data durability and the ability to recover
    from a crash scenario.
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL在数据目录中创建重做日志文件*ib_logfile0*和*ib_logfile1*。它以循环方式写入重做日志文件，因此文件不会超出其配置大小（由[`innodb_log_file_size`](https://oreil.ly/XRzLb)配置）。与任何其他符合ACID的关系数据库管理系统（RDBMS）一样，重做文件是提供数据持久性和从崩溃场景中恢复能力的基础。
- en: The *auto.cnf* file
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: '*auto.cnf*文件'
- en: MySQL 5.6 introduced the *auto.cnf* file. It has only a single `[auto]` section
    containing a single [`server_uuid`](https://oreil.ly/zXlHS) setting and value.
    The `server_uuid` creates a unique signature for the server, and the replication
    layer uses it to communicate with different servers to replicate data.
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 5.6引入了*auto.cnf*文件。它只有一个`[auto]`部分，包含一个[`server_uuid`](https://oreil.ly/zXlHS)设置和值。`server_uuid`为服务器创建一个唯一签名，并且复制层使用它与不同的服务器通信来复制数据。
- en: Warning
  id: totrans-481
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: MySQL automatically creates the *auto.cnf* file in the data directory when initialized,
    and this file should not be changed. We explain the details in [Chapter 9](ch09.xhtml#CH9_OPTIONS_FILE).
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL在初始化时会在数据目录中自动创建*auto.cnf*文件，此文件不应更改。我们在[第9章](ch09.xhtml#CH9_OPTIONS_FILE)中详细解释了其细节。
- en: The **.pem* files
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: '**.pem*文件'
- en: In short, these files enable the use of encrypted connections for communication
    between a client and the MySQL server. Encrypted connections are a fundamental
    part of the network security layer to avoid unauthorized access while the data
    is in transit from the application to the MySQL server. MySQL 5.7 enables SSL
    by default and creates the certificates as well. However, it is possible to use
    certificates provided by different certificate authorities (CAs) in the market.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，这些文件允许在客户端和MySQL服务器之间的通信中使用加密连接。加密连接是网络安全层的基本部分，以避免在数据从应用程序传输到MySQL服务器时未经授权的访问。MySQL
    5.7默认启用SSL并创建证书。但是，可以使用市场上不同证书颁发机构（CA）提供的证书。
- en: The *performance_schema* subdirectory
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: '*performance_schema*子目录'
- en: 'The MySQL Performance Schema is a feature for monitoring MySQL Server execution
    at a low level during runtime. When we can use Performance Schema to monitor a
    particular metric, we say that MySQL has instrumentation. For example, Performance
    Schema instruments can provide the number of users connected:'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL性能模式是在运行时监视MySQL服务器执行的功能。当我们可以使用性能模式来监视特定指标时，我们说MySQL具有仪器化。例如，性能模式仪表可以提供连接用户的数量：
- en: '[PRE103]'
  id: totrans-487
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: '[PRE104]'
  id: totrans-488
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: Note
  id: totrans-489
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'Many people are surprised to see `NULL` in the `user` column. The `NULL` value
    is used for internal threads or for a user session that failed to authenticate.
    The same applies to the `host` column in the `performance_schema.accounts` table:'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: 许多人看到`user`列中的`NULL`时感到惊讶。`NULL`值用于内部线程或认证失败的用户会话。`performance_schema.accounts`表中的`host`列也是如此。
- en: '[PRE105]'
  id: totrans-491
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: '[PRE106]'
  id: totrans-492
  prefs: []
  type: TYPE_PRE
  zh: '[PRE106]'
- en: Although instrumentation has existed since MySQL 5.6, it was in MySQL 5.7 that
    it gained many improvements and became a fundamental part of the DBA tools to
    investigate and troubleshoot issues at the MySQL level.
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管自MySQL 5.6以来就存在仪器化功能，但在MySQL 5.7中它获得了许多改进，并成为DBA工具中调查和解决MySQL级别问题的基础部分。
- en: The *ibtmp1* file
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: '*ibtmp1*文件'
- en: When the application needs to create temporary tables or MySQL needs to use
    an on-disk internal temporary table, MySQL creates them in a shared temporary
    tablespace. The default behavior is to create an auto-extending data file named
    *ibtmp1* that is slightly larger than 12 MB (its size is controlled by the [`innodb_temp_data_file_path`
    parameter](https://oreil.ly/KXDOo)).
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 当应用程序需要创建临时表或MySQL需要使用磁盘上的内部临时表时，它们会创建在共享临时表空间中。默认行为是创建一个名为*ibtmp1*的自动扩展数据文件，稍大于12
    MB（其大小由[`innodb_temp_data_file_path`参数](https://oreil.ly/KXDOo)控制）。
- en: The *ibdata1* file
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: '*ibdata1*文件'
- en: The *ibdata1* file is probably the most famous file in the MySQL ecosystem.
    For MySQL 5.7 and older, it holds data for the InnoDB data dictionary, the doublewrite
    buffer, the change buffer, and the undo logs. It may also contain table and index
    data if we disable the [`innodb_file_per_table` option](https://oreil.ly/v4X1O).
    When `innodb_file_per_table` is enabled, each user table has a tablespace and
    a dedicated file. Note that it is possible to have multiple *ibdata* files in
    the MySQL data directory.
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: '*ibdata1*文件可能是MySQL生态系统中最著名的文件。对于MySQL 5.7及更早版本，它保存InnoDB数据字典、双写缓冲、变更缓冲和撤销日志的数据。如果我们禁用[`innodb_file_per_table`选项](https://oreil.ly/v4X1O)，它还可能包含表和索引数据。当启用`innodb_file_per_table`时，每个用户表都有一个表空间和一个专用文件。请注意，MySQL数据目录中可能存在多个*ibdata*文件。'
- en: Note
  id: totrans-498
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: In MySQL 8.0, some of these components were removed from *ibdata1* and allocated
    into separate files. The remaining components are the change buffer table and
    index data if tables are created in the system tablespace (by disabling the `innodb_file_per_table`).
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 在MySQL 8.0中，一些组件已从*ibdata1*中移除并分配到单独的文件中。剩余的组件包括变更缓冲表和索引数据（如果表被创建在系统表空间中，通过禁用`innodb_file_per_table`）。
- en: The *mysql.sock* file
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: '*mysql.sock*文件'
- en: This is a Unix socket file that the server uses for communication with local
    clients. This file exists only when MySQL is running, and removing it or creating
    the file manually may lead to problems.
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 这是Unix套接字文件，服务器用它与本地客户端进行通信。此文件仅在MySQL运行时存在，手动删除或创建可能会导致问题。
- en: Note
  id: totrans-502
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: A Unix socket is an interprocess communication mechanism that allows bidirectional
    data exchange between processes running on the same machine. IP sockets (mainly
    TCP/IP sockets) are a mechanism allowing communication between processes over
    the network.
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: Unix套接字是一种允许同一台机器上运行的进程之间进行双向数据交换的进程间通信机制。IP套接字（主要是TCP/IP套接字）是一种允许进程之间通过网络进行通信的机制。
- en: 'You can connect to MySQL Server on Linux using two methods: the TCP protocol
    or a socket. For security purposes, if the application and MySQL are on the same
    server, you can disable remote TCP connections. There are two ways to do this
    in MySQL Server: set the [`bind-address`](https://oreil.ly/PQjrf) to `127.0.0.1`
    instead of the default `*` value (which accepts TCP/IP connections from everyone),
    or modify the [`skip-networking` parameter](https://oreil.ly/s20Ta), which disables
    network connections to MySQL.'
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用两种方法在Linux上连接到MySQL服务器：TCP协议或套接字。出于安全目的，如果应用程序和MySQL位于同一服务器上，可以禁用远程TCP连接。在MySQL服务器中有两种方法可以做到这一点：将[`bind-address`](https://oreil.ly/PQjrf)设置为`127.0.0.1`而不是默认的`*`值（接受来自所有人的TCP/IP连接），或修改[`skip-networking`参数](https://oreil.ly/s20Ta)，禁用到MySQL的网络连接。
- en: The *mysql* subdirectory
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: '*mysql*子目录'
- en: 'The *mysql* directory corresponds to the MySQL system schema, which contains
    MySQL Server’s information as it runs. For example, it includes information on
    users and their privileges, time zone tables, and replication. You can see the
    files named according to their respective table names with the `ls` command:'
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: '*mysql*目录对应MySQL系统模式，包含MySQL服务器运行时的信息。例如，它包括用户及其权限、时区表和复制信息。您可以使用`ls`命令查看按其相应表名命名的文件：'
- en: '[PRE107]'
  id: totrans-507
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: MySQL 8.0 Default Files
  id: totrans-508
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MySQL 8.0默认文件
- en: 'MySQL 8.0 brought a few changes in the core of the data directory structure.
    Some of these changes are related to implementing the new data dictionary, and
    others to improving database management. The following list describes the new
    files and changes:'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 8.0在数据目录结构的核心引入了一些变化。其中一些变化与实施新数据字典相关，另一些则是为了改进数据库管理。以下列表描述了新文件和更改：
- en: The *undo* tablespace files
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: '*undo*表空间文件'
- en: MySQL (InnoDB) uses *undo* files to undo the transactions that need to be rolled
    back and ensure isolated transactions whenever it needs to perform a consistent
    read.
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL（InnoDB）使用*undo*文件来撤销需要回滚的事务，并在需要执行一致性读取时确保隔离的事务。
- en: From MySQL 8.0, the undo log files were separated from the system tablespace
    (*ibdata1*) and placed in the data directory. It is also possible to set another
    location by changing the [`innodb_undo_directory` parameter](https://oreil.ly/l1bIV).
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 从 MySQL 8.0 开始，撤消日志文件已从系统表空间（*ibdata1*）中分离，并放置在数据目录中。还可以通过更改 [`innodb_undo_directory`
    参数](https://oreil.ly/l1bIV) 来设置另一个位置。
- en: The *.dblwr* files (introduced in version 8.0.20)
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: '*.dblwr* 文件（从 8.0.20 版本引入）'
- en: 'The doublewrite buffer is responsible for writing pages flushed from the buffer
    pool to the disk before MySQL writes the pages to the datafiles. The doublewrite
    filenames have the following format: *#ib_<page_size>_<file_number>.dblwr* (for
    example, *#ib_16384_0.dblwr*, *#ib_16384_0.dblwr*). It is possible to change the
    location of these files by modifying the [`innodb_doublewrite_dir` parameter](https://oreil.ly/e0ypB).'
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: 双写缓冲区负责在 MySQL 将页面写入数据文件之前将其从缓冲池刷新到磁盘上写入页面。双写文件名的格式如下：*#ib_<page_size>_<file_number>.dblwr*（例如，*#ib_16384_0.dblwr*，*#ib_16384_0.dblwr*）。可以通过修改
    [`innodb_doublewrite_dir` 参数](https://oreil.ly/e0ypB) 来更改这些文件的位置。
- en: The *mysql.ibd* file (introduced in version 8.0)
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: '*mysql.ibd* 文件（从 8.0 版本引入）'
- en: In MySQL 5.7, dictionary tables and system tables stored data and metadata in
    the *mysql* directory inside the *datadir*. In MySQL 8.0, this is all stored in
    the *mysql.ibd* file and is protected by the InnoDB mechanisms to ensure consistency.
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: 在 MySQL 5.7 中，字典表和系统表将数据和元数据存储在 *datadir* 目录内的 *mysql* 目录中。在 MySQL 8.0 中，所有这些数据都存储在
    *mysql.ibd* 文件中，并由 InnoDB 机制保护以确保一致性。
- en: Using the Command-Line Interface
  id: totrans-517
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用命令行界面
- en: 'The *mysql* binary is a simple SQL shell with input line-editing capabilities.
    Its use is straightforward (we already used it a few times during the installation
    process). To invoke it, run the following command:'
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: '*mysql* 二进制文件是一个带有输入行编辑功能的简单 SQL shell。其使用方法很简单（在安装过程中我们已经用过几次）。要调用它，请运行以下命令：'
- en: '[PRE108]'
  id: totrans-519
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: 'We can extend its functionality by executing queries in it:'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过在其中执行查询来扩展其功能：
- en: '[PRE109]'
  id: totrans-521
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: 'And we can execute more advanced commands, piping them with other commands
    to perform more complex tasks. For example, we can extract a dump from one database,
    send it across the network, and restore it into another MySQL server in the same
    command line:'
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以执行更高级的命令，将其与其他命令进行管道连接，以执行更复杂的任务。例如，我们可以从一个数据库中提取转储文件，通过网络发送并在另一个 MySQL
    服务器中还原，所有这些都可以在同一个命令行中完成：
- en: '[PRE110]'
  id: totrans-523
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: MySQL 8.0 introduced *MySQL Shell*, which is way more powerful than its predecessor.
    MySQL Shell supports the JavaScript, Python, and SQL languages, providing development
    and administration capabilities for MySQL Server. We’ll go into more detail about
    this in [“MySQL Shell”](ch16.xhtml#MYSQL-SHELL).
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 8.0 引入了 *MySQL Shell*，比其前身功能强大得多。MySQL Shell 支持 JavaScript、Python 和 SQL
    语言，为 MySQL Server 提供开发和管理功能。我们将在 [“MySQL Shell”](ch16.xhtml#MYSQL-SHELL) 中详细介绍这一点。
- en: Using Docker
  id: totrans-525
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Docker
- en: With the advent of virtualization and its popularization with cloud services,
    many platforms have emerged, including [Docker](https://www.docker.com). Born
    in 2013, Docker is a solution that offers a portable and flexible way to deploy
    software. It provides resource isolation through the use of Linux features like
    *cgroups* and *kernel namespaces*.
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 随着虚拟化技术的出现及其在云服务中的普及，出现了许多平台，包括 [Docker](https://www.docker.com)。Docker 诞生于
    2013 年，提供了一种便捷灵活的部署软件的方式。它通过使用 Linux 的 *cgroups* 和 *kernel namespaces* 等特性实现资源隔离。
- en: Docker is useful for DBAs who often need to install a specific version of MySQL,
    MariaDB, or Percona Server for MySQL to run some experiments. With Docker, it
    is possible to deploy a MySQL instance in seconds to perform some tests. Once
    you finish the tests, you can destroy the instance and release the operating system’s
    resources to other tasks. All the processes of deploying a virtual machine (VM),
    installing packages, and configuring the database are simpler when using Docker.
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: 对于经常需要安装特定版本的 MySQL、MariaDB 或 Percona Server for MySQL 进行实验的 DBA 来说，Docker 很有用。使用
    Docker，可以在几秒钟内部署一个 MySQL 实例来执行一些测试。测试完成后，可以销毁实例并将操作系统的资源释放给其他任务。当使用 Docker 时，部署虚拟机（VM）、安装软件包和配置数据库的所有过程都更加简单。
- en: Installing Docker
  id: totrans-528
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Docker
- en: An advantage of using Docker is that once the service is running, the commands
    are the same in all operating systems. The commands being the same means that
    the learning curve for using Docker is faster compared to learning different Linux
    versions such as CentOS and Ubuntu, for example.
  id: totrans-529
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Docker 的优势在于一旦服务运行，命令在所有操作系统中都是相同的。命令相同意味着使用 Docker 的学习曲线比学习不同的 Linux 版本（如
    CentOS 和 Ubuntu）要快。
- en: The process for [installing Docker](https://oreil.ly/K1zGS) is, in some ways,
    similar to installing MySQL. For Windows and macOS you just install the binaries,
    and after that the service is up and running. For Linux-based operating systems
    without a graphic interface, the process requires configuring the repository.
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: '[安装 Docker](https://oreil.ly/K1zGS) 的过程在某些方面与安装 MySQL 类似。对于 Windows 和 macOS，只需安装二进制文件，然后服务即可运行。对于没有图形界面的基于
    Linux 的操作系统，该过程需要配置存储库。'
- en: Installing Docker on CentOS 7
  id: totrans-531
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 CentOS 7 上安装 Docker
- en: The CentOS packages for Docker are, in general, older than the ones available
    to RHEL and in official Docker repositories. At the time of writing, the Docker
    version provided by regular CentOS repositories is 1.13.1, whereas the upstream
    stable version is 20.10.3\. There is no difference for the purposes of this book,
    but we always recommend using the latest version for production environments.
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，CentOS 提供的 Docker 软件包比 RHEL 和官方 Docker 存储库中的版本旧。目前为止，常规 CentOS 存储库提供的
    Docker 版本为 1.13.1，而上游的稳定版本为 20.10.3。对于本书的目的没有区别，但我们始终建议在生产环境中使用最新版本。
- en: 'Execute the following command to install the Docker package from the default
    CentOS repository:'
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下命令从默认的 CentOS 存储库安装 Docker 软件包：
- en: '[PRE111]'
  id: totrans-534
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: 'If you want to install Docker from the upstream repository to ensure that you
    are using the latest release, follow these steps:'
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: 如果要从上游存储库安装 Docker 以确保使用最新版本，请按照以下步骤操作：
- en: 'Install `yum-utils` to enable the `yum-config-manager` command:'
  id: totrans-536
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装`yum-utils`以启用`yum-config-manager`命令：
- en: '[PRE112]'
  id: totrans-537
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE112]'
- en: 'Use `yum-config-manager` to add the *docker-ce* repository:'
  id: totrans-538
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`yum-config-manager`添加*docker-ce*存储库：
- en: '[PRE113]'
  id: totrans-539
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE113]'
- en: 'Install the necessary packages:'
  id: totrans-540
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装必要的软件包：
- en: '[PRE114]'
  id: totrans-541
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE114]'
- en: 'Start the Docker service:'
  id: totrans-542
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 Docker 服务：
- en: '[PRE115]'
  id: totrans-543
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE115]'
- en: 'Enable the Docker service to auto-start after a system reboot:'
  id: totrans-544
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 Docker 服务以在系统重新启动后自动启动：
- en: '[PRE116]'
  id: totrans-545
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE116]'
- en: 'To validate whether the Docker service is running, execute the `systemctl status`
    command:'
  id: totrans-546
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要验证 Docker 服务是否正在运行，请执行`systemctl status`命令：
- en: '[PRE117]'
  id: totrans-547
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE117]'
- en: 'To verify that Docker Engine is installed correctly, you can run the *hello-world*
    container:'
  id: totrans-548
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要验证 Docker 引擎是否正确安装，可以运行*hello-world*容器：
- en: '[PRE118]'
  id: totrans-549
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE118]'
- en: Installing Docker on Ubuntu 20.04 (Focal Fossa)
  id: totrans-550
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 Ubuntu 20.04（Focal Fossa）上安装 Docker
- en: 'To install the latest Docker release from the upstream repository, first remove
    any older versions of Docker (called *docker*, *docker.io*, or *docker-engine*).
    Uninstall them with this command:'
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: 要从上游存储库安装最新的 Docker 发行版，请首先移除任何旧版本的 Docker（称为*docker*、*docker.io*或*docker-engine*）。使用以下命令卸载它们：
- en: '[PRE119]'
  id: totrans-552
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: 'With the default repository removed, you can initiate the installation process:'
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 移除默认存储库后，您可以启动安装过程：
- en: 'Make sure that Ubuntu is up-to-date with this command:'
  id: totrans-554
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保 Ubuntu 使用此命令保持最新：
- en: '[PRE120]'
  id: totrans-555
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE120]'
- en: 'Install packages to allow *apt* to use a repository over HTTPS:'
  id: totrans-556
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装软件包以允许*apt*通过 HTTPS 使用存储库：
- en: '[PRE121]'
  id: totrans-557
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE121]'
- en: 'Next, add Docker’s official GPG key:'
  id: totrans-558
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，添加 Docker 官方的 GPG 密钥：
- en: '[PRE122]'
  id: totrans-559
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE122]'
- en: 'With the key in place, add the Docker stable repository:'
  id: totrans-560
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装好密钥后，添加 Docker 稳定存储库：
- en: '[PRE123]'
  id: totrans-561
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE123]'
- en: 'Now, use the `apt` command to install the Docker packages:'
  id: totrans-562
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用`apt`命令安装 Docker 软件包：
- en: '[PRE124]'
  id: totrans-563
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE124]'
- en: 'Ubuntu will start the service for you, but you can check by running this command:'
  id: totrans-564
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Ubuntu 将为您启动服务，但您可以通过运行此命令进行检查：
- en: '[PRE125]'
  id: totrans-565
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE125]'
- en: 'To make the Docker service auto-start when the OS reboots, use:'
  id: totrans-566
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要使 Docker 服务在操作系统重新启动时自动启动，请使用：
- en: '[PRE126]'
  id: totrans-567
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE126]'
- en: 'Check the Docker version you installed with:'
  id: totrans-568
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令检查您安装的 Docker 版本：
- en: '[PRE127]'
  id: totrans-569
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE127]'
- en: 'To verify that Docker Engine is installed correctly, you can run the *hello-world*
    container:'
  id: totrans-570
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要验证 Docker 引擎是否正确安装，可以运行*hello-world*容器：
- en: '[PRE128]'
  id: totrans-571
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE128]'
- en: Deploying the MySQL container
  id: totrans-572
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 部署 MySQL 容器
- en: Once you have Docker Engine installed and running, the next step is deploying
    the MySQL Docker container.
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 安装并运行 Docker 引擎后的下一步是部署 MySQL Docker 容器。
- en: Warning
  id: totrans-574
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: We designed the following instructions to get a test instance running quickly
    and easily; do not use this for a production deployment!
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: 我们设计了以下指南，以便快速轻松地运行测试实例；请勿将其用于生产部署！
- en: 'To deploy the latest MySQL version with Docker, execute this command:'
  id: totrans-576
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 Docker 部署最新的 MySQL 版本，请执行此命令：
- en: '[PRE129]'
  id: totrans-577
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: Docker Engine will launch the latest version of the MySQL instance and be remotely
    accessible from anywhere with the specified root password. Installing MySQL with
    Docker means that you do not have access to any of the tools, utilities, or standard
    libraries available in a traditional host (bare metal or VM). You’ll need to either
    deploy these tools separately or use commands shipped with the Docker image if
    you need them.
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: Docker 引擎将启动 MySQL 实例的最新版本，并且可以通过指定的 root 密码从任何地方远程访问。使用 Docker 安装 MySQL 意味着您无法访问传统主机（裸机或虚拟机）上可用的任何工具、实用程序或标准库。如果需要这些工具，您需要单独部署这些工具或使用与
    Docker 镜像一起提供的命令。
- en: 'Next, connect to the MySQL container using the MySQL client:'
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用 MySQL 客户端连接到 MySQL 容器：
- en: '[PRE130]'
  id: totrans-580
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: Since you mapped the TCP port 3306 in the container to port 3306 on the Docker
    host with the parameter `-p 3306:3306`, you can connect to the MySQL database
    from any MySQL client (Workbench, MySQL Shell) available that can reach the host
    (hostname or IP) and that port.
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 由于您将容器中的 TCP 端口 3306 映射到 Docker 主机的端口 3306，您可以从可以访问主机（主机名或 IP）和该端口的任何 MySQL
    客户端（Workbench、MySQL Shell）连接到 MySQL 数据库。
- en: Let’s look at a few commands to manage the container.
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看一些管理容器的命令。
- en: 'To stop the MySQL Docker container, run:'
  id: totrans-583
  prefs: []
  type: TYPE_NORMAL
  zh: 要停止 MySQL Docker 容器，请运行：
- en: '[PRE131]'
  id: totrans-584
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: 'Don’t try to use `docker run` to start the container again. Instead, use this:'
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: 不要尝试使用 `docker run` 再次启动容器。而是使用以下命令：
- en: '[PRE132]'
  id: totrans-586
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: 'To investigate an issue—for example, if the container isn’t starting—access
    its logs using this command:'
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
  zh: 要调查问题，例如容器无法启动时，请使用以下命令访问其日志：
- en: '[PRE133]'
  id: totrans-588
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: 'To remove the Docker container that you created, run:'
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除您创建的 Docker 容器，请运行：
- en: '[PRE134]'
  id: totrans-590
  prefs: []
  type: TYPE_PRE
  zh: '[PRE134]'
- en: 'To check which and how many Docker containers are running in the host, use:'
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查主机上运行哪些 Docker 容器以及有多少个，请使用：
- en: '[PRE135]'
  id: totrans-592
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: 'It is possible to customize MySQL parametrization using command-line options
    to Docker Engine. To configure the [InnoDB buffer pool size](https://oreil.ly/1R2nJ)
    and the [flush method](https://oreil.ly/tiKl2), run the following:'
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用命令行选项来自定义 MySQL 的参数化到 Docker 引擎。要配置 [InnoDB 缓冲池大小](https://oreil.ly/1R2nJ)
    和 [刷新方法](https://oreil.ly/tiKl2)，请运行以下命令：
- en: '[PRE136]'
  id: totrans-594
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: To run a MySQL version other than the latest version, first check that it is
    available in [Docker Hub](https://hub.docker.com). For example, say you want to
    run MySQL 5.7.31\. The first step is to check the [official MySQL Docker Images](https://oreil.ly/X0Uuu)
    list in Docker Hub to see if it exists.
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行不同于最新版本的 MySQL 版本，请首先检查它是否在 [Docker Hub](https://hub.docker.com) 上可用。例如，假设您想运行
    MySQL 5.7.31。第一步是在 Docker Hub 的 [official MySQL Docker Images](https://oreil.ly/X0Uuu)
    列表中检查它是否存在。
- en: 'Once you’ve confirmed its existence, run it with the following command:'
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确认其存在，使用以下命令运行它：
- en: '[PRE137]'
  id: totrans-597
  prefs: []
  type: TYPE_PRE
  zh: '[PRE137]'
- en: It is possible to run multiple MySQL Docker instances at the same time, but
    a potential problem is TCP port conflicts. In the previous example, note that
    we mapped different host ports for the *mysql-5.7.31* container (3307 and 33061).
    Also, the *name* of the container needs to be unique.
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 可以同时运行多个 MySQL Docker 实例，但潜在问题是 TCP 端口冲突。在前面的例子中，请注意我们为 *mysql-5.7.31* 容器映射了不同的主机端口（3307
    和 33061）。此外，容器的 *名称* 需要是唯一的。
- en: Deploying MariaDB and Percona Server containers
  id: totrans-599
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 部署 MariaDB 和 Percona Server 容器
- en: You follow the same steps described in the previous section for deploying a
    MySQL container to deploy a [MariaDB](https://oreil.ly/rHGjq) or [Percona Server](https://oreil.ly/TAWtw)
    container. The main difference is that they use different Docker images and have
    their own official repositories.
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按照前一部分描述的相同步骤来部署 [MariaDB](https://oreil.ly/rHGjq) 或 [Percona Server](https://oreil.ly/TAWtw)
    容器。主要区别在于它们使用不同的 Docker 镜像，并拥有各自的官方存储库。
- en: 'To deploy a MariaDB container, run:'
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: 要部署一个 MariaDB 容器，请运行：
- en: '[PRE138]'
  id: totrans-602
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: 'And for Percona Server, run:'
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Percona Server，请运行：
- en: '[PRE139]'
  id: totrans-604
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: Note
  id: totrans-605
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'We are mapping different ports for MariaDB (`-p 3308:3306`) and Percona (`-p
    3309:3306`) because we are deploying all the containers in the same host:'
  id: totrans-606
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为 MariaDB (`-p 3308:3306`) 和 Percona (`-p 3309:3306`) 映射了不同的端口，因为我们在同一主机上部署所有容器：
- en: '[PRE140]'
  id: totrans-607
  prefs: []
  type: TYPE_PRE
  zh: '[PRE140]'
- en: '[PRE141]'
  id: totrans-608
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: If you are deploying a single container, you can use port 3306 or any custom
    port you might want to use.
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 如果只部署一个容器，可以使用端口 3306 或任何您想使用的自定义端口。
- en: Using Sandboxes
  id: totrans-610
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用沙箱
- en: In software development, a *sandbox* is a testing environment that isolates
    code changes and allows experimentation and testing before deploying to production.
    DBAs primarily use sandboxes for testing new software versions, performance tests,
    and bug analysis, and the data present in MySQL is disposable.
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: 在软件开发中，*沙箱* 是一个测试环境，用于隔离代码更改，允许在部署到生产环境之前进行实验和测试。DBA 主要用沙箱测试新软件版本、性能测试和故障分析，并且
    MySQL 中的数据是可丢弃的。
- en: Note
  id: totrans-612
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'It is common in the context of MySQL databases to hear the terms *master* and
    *slave*. The origins of these words are clearly negative. Oracle, Percona, and
    MariaDB have therefore decided to change this terminology and instead use *source*
    and *replica*. In this book, we will use both sets of terms because you will encounter
    both of them, but be aware that these companies will implement the following terminology
    for the upcoming releases:'
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 在 MySQL 数据库的背景下，听到 *主节点* 和 *从节点* 这两个术语是很常见的。这些词的起源显然是负面的。因此，Oracle、Percona 和
    MariaDB 已决定更改这些术语，改为使用 *源* 和 *副本*。在本书中，我们将使用这两组术语，因为你会遇到它们，但请注意，这些公司将在即将发布的版本中实施以下术语：
- en: '| **Old** | **New** |'
  id: totrans-614
  prefs: []
  type: TYPE_TB
  zh: '| **旧** | **新** |'
- en: '| master | source |'
  id: totrans-615
  prefs: []
  type: TYPE_TB
  zh: '| 主节点 | 源 |'
- en: '| slave | replica |'
  id: totrans-616
  prefs: []
  type: TYPE_TB
  zh: '| 从节点 | 副本 |'
- en: '| blacklist | blocklist |'
  id: totrans-617
  prefs: []
  type: TYPE_TB
  zh: '| 黑名单 | 阻止列表 |'
- en: '| whitelist | allowlist |'
  id: totrans-618
  prefs: []
  type: TYPE_TB
  zh: '| 白名单 | 允许列表 |'
- en: In 2018, [Giuseppe Maxia](https://oreil.ly/0wLPk) introduced [DBdeployer](https://oreil.ly/lZK98),
    a tool that provides an easy and fast way to deploy MySQL and its forks. It supports
    diverse MySQL topologies such as master/slave (source/replica), master/master
    (source/source), Galera Cluster, and Group Replication.
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
  zh: 在 2018 年，[Giuseppe Maxia](https://oreil.ly/0wLPk) 推出了 [DBdeployer](https://oreil.ly/lZK98)，这是一个提供快速简便方法部署
    MySQL 及其衍生产品的工具。它支持多种 MySQL 拓扑，如主/从（源/副本）、主/主（源/源）、Galera 集群和 Group Replication。
- en: Installing DBdeployer
  id: totrans-620
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 DBdeployer
- en: 'The tool is developed in the *Go* language and works with macOS and Linux (Ubuntu
    and CentOS), and standalone executables are provided. Get the latest version here:'
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: 这个工具是用 *Go* 语言开发的，可以在 macOS 和 Linux（Ubuntu 和 CentOS）上运行，并提供独立的可执行文件。在这里获取最新版本：
- en: '[PRE142]'
  id: totrans-622
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: 'If you have your */usr/local/bin/* directory in the `$PATH` variable, you should
    now be able to run the `dbdeployer` commands:'
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你将 */usr/local/bin/* 目录添加到 `$PATH` 变量中，现在应该能够运行 `dbdeployer` 命令了：
- en: '[PRE143]'
  id: totrans-624
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: Using DBdeployer
  id: totrans-625
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 DBdeployer
- en: 'The first step in using DBdeployer is to download the MySQL binary you want
    to run and unpack it into the directory where you store your binaries. We will
    use [*Linux - Generic* tarballs](https://oreil.ly/DoI1c) since they are compatible
    with most Linux distributions, and we will store our binaries in the */opt/mysql*
    directory:'
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 DBdeployer 的第一步是下载你想要运行的 MySQL 二进制文件，并解压缩到存储二进制文件的目录中。我们将使用 [*Linux - Generic*
    tarballs](https://oreil.ly/DoI1c)，因为它们与大多数 Linux 发行版兼容，并将我们的二进制文件存储在 */opt/mysql*
    目录中：
- en: '[PRE144]'
  id: totrans-627
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
- en: 'The `unpack` command will extract and move the files to the specified directory.
    The expected output of this operation is:'
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: '`unpack` 命令将会提取并移动文件到指定目录。这个操作的预期输出是：'
- en: '[PRE145]'
  id: totrans-629
  prefs: []
  type: TYPE_PRE
  zh: '[PRE145]'
- en: '[PRE146]'
  id: totrans-630
  prefs: []
  type: TYPE_PRE
  zh: '[PRE146]'
- en: 'We can now use the following command to create a new standalone MySQL sandbox
    with the newly extracted binary:'
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用以下命令使用新提取的二进制文件创建一个新的独立 MySQL 沙箱：
- en: '[PRE147]'
  id: totrans-632
  prefs: []
  type: TYPE_PRE
  zh: '[PRE147]'
- en: 'And we can observe DBdeployer initializing MySQL:'
  id: totrans-633
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们可以观察 DBdeployer 初始化 MySQL：
- en: '[PRE148]'
  id: totrans-634
  prefs: []
  type: TYPE_PRE
  zh: '[PRE148]'
- en: '[PRE149]'
  id: totrans-635
  prefs: []
  type: TYPE_PRE
  zh: '[PRE149]'
- en: 'Confirm that MySQL is running with the `ps` command:'
  id: totrans-636
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `ps` 命令确认 MySQL 是否正在运行：
- en: '[PRE150]'
  id: totrans-637
  prefs: []
  type: TYPE_PRE
  zh: '[PRE150]'
- en: '[PRE151]'
  id: totrans-638
  prefs: []
  type: TYPE_PRE
  zh: '[PRE151]'
- en: 'We can now connect to MySQL using DBdeployer’s `use` command:'
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用 DBdeployer 的 `use` 命令连接到 MySQL：
- en: '[PRE152]'
  id: totrans-640
  prefs: []
  type: TYPE_PRE
  zh: '[PRE152]'
- en: 'or using the default root credentials:'
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: 或者使用默认的 root 凭据：
- en: '[PRE153]'
  id: totrans-642
  prefs: []
  type: TYPE_PRE
  zh: '[PRE153]'
- en: Note
  id: totrans-643
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'We got the port information from the previous `ps` command. Remember that there
    are two ways to connect to MySQL: via TCP/IP or using a socket. We can also get
    the socket file location from the output of the `ps` command and connect with
    that, as shown here:'
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从之前的 `ps` 命令中获取了端口信息。请记住，连接到 MySQL 有两种方式：通过 TCP/IP 或使用套接字。我们还可以从 `ps` 命令的输出中获取套接字文件位置，并使用它进行连接，如下所示：
- en: '[PRE154]'
  id: totrans-645
  prefs: []
  type: TYPE_PRE
  zh: '[PRE154]'
- en: 'If we want to set up a replication environment with a source/replica topology,
    we can do it with the following command line:'
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想要设置一个带有源/副本拓扑的复制环境，我们可以使用以下命令行来实现：
- en: '[PRE155]'
  id: totrans-647
  prefs: []
  type: TYPE_PRE
  zh: '[PRE155]'
- en: 'And we will have three `mysqld` processes running:'
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将有三个 `mysqld` 进程在运行：
- en: '[PRE156]'
  id: totrans-649
  prefs: []
  type: TYPE_PRE
  zh: '[PRE156]'
- en: '[PRE157]'
  id: totrans-650
  prefs: []
  type: TYPE_PRE
  zh: '[PRE157]'
- en: 'Another topology that DBdeployer can configure is Group Replication. For this
    example, we will define a `base-port`. By doing this, we will order DBdeployer
    to configure our servers starting from port 49007:'
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: DBdeployer 可以配置的另一种拓扑是 Group Replication。在这个示例中，我们将定义一个 `base-port`。通过这样做，我们将命令
    DBdeployer 从端口 49007 开始配置我们的服务器：
- en: '[PRE158]'
  id: totrans-652
  prefs: []
  type: TYPE_PRE
  zh: '[PRE158]'
- en: 'Now let’s see an example of the deployment of Galera Cluster using Percona
    XtraDB Cluster 5.7.32\. We will indicate the `base-port`, and we want our nodes
    configured with the [`log-slave-updates` option](https://oreil.ly/oMhOY):'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看一个使用 Percona XtraDB Cluster 5.7.32 部署 Galera Cluster 的示例。我们将指定 `base-port`，并希望我们的节点配置为[`log-slave-updates`
    选项](https://oreil.ly/oMhOY)：
- en: '[PRE159]'
  id: totrans-654
  prefs: []
  type: TYPE_PRE
  zh: '[PRE159]'
- en: 'As we’ve seen, it is possible to customize MySQL parameters. One interesting
    option is enabling MySQL replication using [*global transaction identifiers*](https://oreil.ly/QNCBh),
    or GTIDs (we’ll discuss GTIDs in more detail in [Chapter 13](ch13.xhtml#CH13_HA)):'
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，可以定制 MySQL 参数。一个有趣的选项是启用 MySQL 复制，使用[*全局事务标识符*](https://oreil.ly/QNCBh)，或
    GTIDs（我们将在[第13章](ch13.xhtml#CH13_HA)中更详细地讨论 GTIDs）：
- en: '[PRE160]'
  id: totrans-656
  prefs: []
  type: TYPE_PRE
  zh: '[PRE160]'
- en: 'Our last example shows that it is possible to deploy multiple standalone versions
    at once—here, we create five standalone instances:'
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的最后一个示例显示，可以同时部署多个独立版本—在这里，我们创建了五个独立实例：
- en: '[PRE161]'
  id: totrans-658
  prefs: []
  type: TYPE_PRE
  zh: '[PRE161]'
- en: 'The previous examples are just a small sample of DBdeployer’s capabilities.
    The full documentation is available on [GitHub](https://oreil.ly/5ygE0). Another
    option to understand the universe of possibilities is to use `--help` in the command
    line:'
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: 上述示例只是 DBdeployer 能力的一小部分。完整文档可以在[GitHub](https://oreil.ly/5ygE0)上找到。了解各种可能性的另一种选择是在命令行中使用
    `--help`：
- en: '[PRE162]'
  id: totrans-660
  prefs: []
  type: TYPE_PRE
  zh: '[PRE162]'
- en: '[PRE163]'
  id: totrans-661
  prefs: []
  type: TYPE_PRE
  zh: '[PRE163]'
- en: Upgrading MySQL Server
  id: totrans-662
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 升级 MySQL 服务器
- en: 'If the most common question to arise is about replication, the second most
    common is about how to upgrade a MySQL instance. If the procedure is not well
    tested before it’s done in production, the chances of having a problem are high.
    There are two types of upgrades that you can perform:'
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 如果最常见的问题是关于复制，那么第二常见的问题就是如何升级 MySQL 实例。如果在生产环境中未经充分测试过程，则出现问题的可能性很高。可以执行两种类型的升级：
- en: A *major upgrade* in MySQL would be changing versions from 5.6 to 5.7 or 5.7
    to 8.0\. Such an upgrade is trickier and more complex than a minor upgrade because
    the changes to the architecture are more substantial. For example, a considerable
    change in MySQL 8.0 involved modifying the data dictionary, which is now transactional
    and encapsulated by InnoDB.
  id: totrans-664
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 MySQL 中的 *重大升级* 是从版本 5.6 到 5.7 或从 5.7 到 8.0 的更改。这样的升级比小版本升级更复杂，因为对体系结构的更改更为重大。例如，MySQL
    8.0 的重大变化包括修改了数据字典，现在数据字典是事务性的，并由 InnoDB 封装。
- en: A *minor upgrade* would be changing from MySQL 5.7.29 to 5.7.30 or MySQL 8.0.22
    to MySQL 8.0.23\. Most of the time, you’ll need to install the new version using
    your distribution’s package manager. A minor upgrade is simpler than a major one
    because it does not involve any changes in the architecture. The modifications
    are focused on fixing bugs, improving the performance, and optimizing the code.
  id: totrans-665
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*小版本升级* 是从 MySQL 5.7.29 到 5.7.30 或从 MySQL 8.0.22 到 MySQL 8.0.23 的更改。大多数情况下，您需要使用发行版的软件包管理器安装新版本。小版本升级比重大版本升级简单，因为它不涉及体系结构的任何更改。修改集中在修复错误、提高性能和优化代码上。'
- en: 'To start planning for an upgrade, first choose between two strategies. These
    are the recommended strategies according to the documentation and are the ones
    we use:'
  id: totrans-666
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始规划升级，首先要在两种策略之间进行选择。这是文档推荐的策略，也是我们使用的策略：
- en: In-place upgrade
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: 原地升级
- en: This involves shutting down MySQL, replacing the old MySQL binaries or packages
    with the new ones, restarting MySQL in the existing data directory, and running
    `mysql_upgrade`.
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 这涉及到关闭 MySQL，用新的 MySQL 二进制文件或软件包替换旧的，重启 MySQL 在现有数据目录中，然后运行 `mysql_upgrade`。
- en: Note
  id: totrans-669
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'As of MySQL 8.0.16, the *mysql_upgrade* binary is deprecated, and the MySQL
    server itself executes its functionality (you can think of it as a “server upgrade”).
    MySQL added this change alongside the data dictionary upgrade (DD upgrade), which
    is a process to update the data dictionary table definitions. Benefits of the
    new process include:'
  id: totrans-670
  prefs: []
  type: TYPE_NORMAL
  zh: 自 MySQL 8.0.16 开始，*mysql_upgrade* 二进制文件已被弃用，MySQL 服务器本身执行其功能（您可以将其视为“服务器升级”）。MySQL
    在数据字典升级（DD 升级）旁边添加了这一变化，数据字典升级是更新数据字典表定义的过程。新流程的好处包括：
- en: Faster upgrades
  id: totrans-671
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更快的升级速度
- en: Simpler process
  id: totrans-672
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更简单的过程
- en: Better security
  id: totrans-673
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更好的安全性
- en: Significant reduction in upgrade steps
  id: totrans-674
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显著减少升级步骤
- en: More easily automated
  id: totrans-675
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更容易自动化
- en: No restarts
  id: totrans-676
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无重启
- en: Plug and play
  id: totrans-677
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 即插即用
- en: Logical upgrade
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑升级
- en: This involves exporting the data in SQL format from the old MySQL version using
    a backup or export utility such as *mysqldump* or *mysqlpump*, installing the
    new MySQL version, and applying the SQL data to the new MySQL version. In other
    words, this process involves rebuilding the entire data dictionary and the user
    data. A logical upgrade usually takes longer than an in-place upgrade.
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: 这涉及使用备份工具或导出工具（如 *mysqldump* 或 *mysqlpump*）从旧版本的 MySQL 导出 SQL 格式的数据，安装新版本的 MySQL，并将
    SQL 数据应用到新版本的 MySQL。换句话说，此过程涉及重建整个数据字典和用户数据。逻辑升级通常比原地升级需要更长的时间。
- en: Regardless of your chosen strategy, it is essential to establish a rollback
    strategy in case something goes wrong. The rollback strategy will vary based on
    the upgrade plan you choose, and the database size and the topology present (if
    you’re using replicas or Galera Cluster, for example) will influence this decision.
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: 无论选择了哪种策略，建立回滚策略都是必要的，以防出现问题。回滚策略将根据您选择的升级计划、数据库大小和当前拓扑结构（例如是否使用副本或 Galera 集群）而有所不同。
- en: 'Here are some additional points to take into consideration when planning an
    upgrade:'
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: 在规划升级时，请考虑以下一些额外的要点：
- en: Upgrading from MySQL 5.7 to 8.0 is supported. However, the upgrade is only supported
    between GA releases. For MySQL 8.0, it is required that you upgrade from a MySQL
    5.7 GA release (5.7.9 or higher). Upgrades from non-GA releases of MySQL 5.7 are
    not supported.
  id: totrans-682
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持从 MySQL 5.7 升级到 8.0。但是，升级仅在 GA 版本之间支持。对于 MySQL 8.0，必须从 MySQL 5.7 的 GA 发行版（5.7.9
    或更高版本）升级。不支持从 MySQL 5.7 的非 GA 版本进行升级。
- en: Upgrading to the latest release is recommended before upgrading to the next
    version. For example, upgrade to the latest MySQL 5.7 release before upgrading
    to MySQL 8.0.
  id: totrans-683
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 建议在升级到下一个版本之前先升级到最新版本。例如，在升级到 MySQL 8.0 之前，先升级到最新的 MySQL 5.7 版本。
- en: Upgrades that skip versions are not supported. For example, upgrading directly
    from MySQL 5.6 to 8.0 is not supported.
  id: totrans-684
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持跳过版本进行升级。例如，直接从 MySQL 5.6 升级到 8.0 是不支持的。
- en: Note
  id: totrans-685
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: Based on our experience, moving from MySQL 5.6 to MySQL 5.7 is the upgrade that
    causes the most performance issues, especially if the application is using *derived
    tables* (see [“Nested Queries in the FROM Clause”](ch05.xhtml#ADV1-SEC-NESTEDFROM)).
    MySQL 5.7 modified the [`optimizer_switch` system variable](https://oreil.ly/m0Ky3),
    enabling the [`derived_merge` setting](https://oreil.ly/JROqc) by default, and
    this can hurt query performance.
  id: totrans-686
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的经验，从 MySQL 5.6 升级到 MySQL 5.7 是导致性能问题最多的升级，特别是如果应用程序使用了 *派生表*（参见 [“FROM
    子句中的嵌套查询”](ch05.xhtml#ADV1-SEC-NESTEDFROM)）。MySQL 5.7 修改了 [`optimizer_switch`
    系统变量](https://oreil.ly/m0Ky3)，默认启用了 [`derived_merge` 设置](https://oreil.ly/JROqc)，这可能影响查询性能。
- en: Another complicating change is that MySQL 5.7 implements network encryption
    by default (SSL). Applications that were not using SSL in MySQL 5.6 may suffer
    a substantial performance hit.
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个复杂的变化是，MySQL 5.7 默认实现了网络加密（SSL）。在 MySQL 5.6 中未使用 SSL 的应用可能会遭受重大的性能损失。
- en: Finally, MySQL 5.7 changed the [`sync_binlog`](https://oreil.ly/Khh3Q) default
    to synchronous mode. This mode is the safest but can harm performance due to the
    increased number of disk writes.
  id: totrans-688
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，MySQL 5.7 将 [`sync_binlog`](https://oreil.ly/Khh3Q) 默认更改为同步模式。这种模式最安全，但由于增加了磁盘写入次数，可能会影响性能。
- en: 'Let’s go through an example of upgrading from MySQL 5.7 upstream to MySQL 8.0
    upstream using the in-place method:'
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个示例来详细介绍如何使用原地升级方法从 MySQL 5.7 升级到 MySQL 8.0：
- en: 'Stop the MySQL service. Perform a clean shutdown using `systemctl`:'
  id: totrans-690
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 停止 MySQL 服务。使用 `systemctl` 执行干净的关闭操作：
- en: '[PRE164]'
  id: totrans-691
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE164]'
- en: 'Remove the old binaries:'
  id: totrans-692
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除旧的二进制文件：
- en: '[PRE165]'
  id: totrans-693
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE165]'
- en: This process only removes the binaries and does not touch the *datadir* (see
    [“The Contents of the MySQL Directory”](#MYSQL_DIRECTORY_CONTENT)).
  id: totrans-694
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此过程仅移除二进制文件，并不触及 *datadir*（参见 [“MySQL 目录的内容”](#MYSQL_DIRECTORY_CONTENT)）。
- en: 'Follow the regular steps for the installation process (see [“Installing MySQL
    on Linux”](#MYSQL-INSTALL-LINUX)). For example, to use MySQL 8.0 Community Version
    on CentOS 7 using `yum`:'
  id: totrans-695
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 遵循安装过程的常规步骤（参见 [“在 Linux 上安装 MySQL”](#MYSQL-INSTALL-LINUX)）。例如，在 CentOS 7 上使用
    `yum` 安装 MySQL 8.0 社区版本：
- en: '[PRE166]'
  id: totrans-696
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE166]'
- en: 'Install the new binaries:'
  id: totrans-697
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装新的二进制文件：
- en: '[PRE167]'
  id: totrans-698
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE167]'
- en: 'Start the MySQL service:'
  id: totrans-699
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 MySQL 服务：
- en: '[PRE168]'
  id: totrans-700
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE168]'
- en: 'We can observe in the logs that MySQL upgraded the data dictionary and that
    we’re now running MySQL 8.0.21:'
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在日志中观察到，MySQL 已经升级了数据字典，并且现在运行的是 MySQL 8.0.21：
- en: '[PRE169]'
  id: totrans-702
  prefs: []
  type: TYPE_PRE
  zh: '[PRE169]'
- en: '[PRE170]'
  id: totrans-703
  prefs: []
  type: TYPE_PRE
  zh: '[PRE170]'
- en: Note
  id: totrans-704
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: We highly recommend before upgrading MySQL that you check the release notes.
    They contain a summary of the changes made and the bug fixes. Release notes are
    available for [MySQL upstream](https://oreil.ly/FcOVq), [Percona Server](https://oreil.ly/Mtt2J),
    and [MariaDB](https://oreil.ly/T8M9z).
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: 我们强烈建议在升级MySQL之前查看发布说明。它们包含所做更改和bug修复的摘要。MySQL的发布说明可以在[MySQL upstream](https://oreil.ly/FcOVq)，[Percona
    Server](https://oreil.ly/Mtt2J)，和[MariaDB](https://oreil.ly/T8M9z)找到。
- en: A common question is whether it’s safe to upgrade to the latest major release.
    The answer is…it depends. As with any new product in the industry, early adopters
    tend to benefit from the new features, but they are testers as well, and they
    may discover and be affected by new bugs. When MySQL 8.0 was released, our recommendation
    was to wait for three minor releases before considering moving. The golden rule
    of this book is to test everything in advance before executing the next step.
    If you learn just that from this book, we will consider our mission accomplished.
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: 一个常见的问题是是否安全升级到最新的主要版本。答案是……这取决于情况。和行业中的任何新产品一样，早期采纳者倾向于从新功能中受益，但他们也是测试者，可能会发现并受到新bug的影响。当MySQL
    8.0发布时，我们的建议是在考虑迁移之前等待三个次要版本。本书的黄金法则是在执行下一步之前先测试所有内容。如果你从本书中只学到这一点，我们将认为我们的使命已经完成。
